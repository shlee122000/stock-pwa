<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#1e3a5f">
  <meta name="description" content="AI 기반 주식 분석 프로그램">
  <link rel="manifest" href="/manifest.json">
  <title>📈 AI 주식 분석</title>
  
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
  <!-- CSS -->
  <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
  <div class="app-container">
    <!-- 사이드바 -->
    <aside class="sidebar">
      <div class="logo">
        <h1>📈 AI 주식분석</h1>
      </div>
      
      <nav class="nav-menu">
        <button class="nav-item active" data-tab="dashboard">🏠 대시보드</button>
        <button class="nav-item" data-tab="search">🔍 종목 검색</button>
        <button class="nav-item" data-tab="theme">🎯 테마 분석</button>
        <button class="nav-item" data-tab="stock-finder">🔍 종목 찾기</button>
        <button class="nav-item" data-tab="analysis">📊 기술적 분석</button>
        <button class="nav-item" data-tab="signals">🚦 매매 신호</button>
        <button class="nav-item" data-tab="watchlist">⭐ 관심 종목</button>
        <button class="nav-item" data-tab="us-stock">🇺🇸 미국 주식</button>
        <button class="nav-item" data-tab="portfolio">💼 내 포트폴리오</button>
        <button class="nav-item" data-tab="portfolio-optimizer">📊 포트폴리오 최적화</button>
        <button class="nav-item" data-tab="us-stock-finder">🔍 미국 종목 찾기</button>
        <button class="nav-item" data-tab="ai-lesson">🤖 AI 레슨</button>
      </nav>
      

      <!-- 로그인 영역 -->
      <div style="margin-top:20px;">
        <button id="login-btn" class="nav-item" onclick="openAuthModal()" style="width:100%; background:rgba(59,130,246,0.3);">
          🔐 로그인
        </button>
        <div id="user-info" class="user-info" style="display:none;"></div>
      </div>


     <!-- 환율 정보 (사이드바) -->
      <div class="exchange-rate-box">
        <h4>💱 환율</h4>
        <div id="exchange-rate-info">
          <p>로딩 중...</p>
        </div>
      </div>
      
      <!-- 모바일 메뉴 버튼 -->
      <button class="mobile-menu-btn" id="mobile-menu-btn">☰</button>
    </aside>
    
    <!-- 메인 컨텐츠 -->
    <main class="main-content">
      
      <!-- 대시보드 -->
      <section id="tab-dashboard" class="tab-content active">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
          <h2 style="margin: 0;">🏠 대시보드</h2>
          <button id="refresh-dashboard-btn" class="btn-primary" style="padding: 8px 16px;">
            🔄 새로고침
          </button>
        </div>
        <div class="dashboard-grid">
          
          <div class="card">
            <h3>📊 오늘의 시장</h3>
            <div id="market-summary">로딩 중...</div>
          </div>
          
          <div class="card">
            <h3>💰 내 포트폴리오 요약</h3>
            <div id="dashboard-portfolio-summary">
              <p>로딩 중...</p>
            </div>
          </div>
          
          <div class="card">
            <h3>🔔 알림 현황</h3>
            <div id="dashboard-alert-summary">
              <p>로딩 중...</p>
            </div>
          </div>
          
          <div class="card dashboard-exchange-card">
            <h3>💱 환율 정보</h3>
            <div id="dashboard-exchange-rate">
              <p>로딩 중...</p>
            </div>
          </div>
          
          <div class="card">
            <h3>🔥 추천 종목</h3>
            <div id="recommended-stocks">로딩 중...</div>
          </div>
          
          <div class="card">
            <h3>📰 주요 뉴스</h3>
            <div id="main-news">로딩 중...</div>
          </div>
          
          <!-- 성능 모니터링 패널 -->
          <div class="card" style="border: 2px solid #3b82f6;">
            <div style="display: flex; justify-content: space-between; align-items: center; cursor: pointer;" onclick="togglePerformancePanel()">
              <h3 style="margin: 0;">📊 성능 모니터링</h3>
              <span id="performance-toggle" style="font-size: 1.5rem;">▼</span>
            </div>
            <div id="performance-panel" style="margin-top: 15px;">
              <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                
                <div style="padding: 15px; background: #f0f9ff; border-radius: 8px;">
                  <div style="font-size: 0.9rem; color: #64748b; margin-bottom: 5px;">캐시 적중률</div>
                  <div id="perf-hit-rate" style="font-size: 1.5rem; font-weight: bold; color: #3b82f6;">0%</div>
                </div>
                
                <div style="padding: 15px; background: #f0fdf4; border-radius: 8px;">
                  <div style="font-size: 0.9rem; color: #64748b; margin-bottom: 5px;">캐시 항목 수</div>
                  <div id="perf-cache-size" style="font-size: 1.5rem; font-weight: bold; color: #10b981;">0</div>
                </div>
                
                <div style="padding: 15px; background: #fef3c7; border-radius: 8px;">
                  <div style="font-size: 0.9rem; color: #64748b; margin-bottom: 5px;">API 호출 (캐시 미스)</div>
                  <div id="perf-api-calls" style="font-size: 1.5rem; font-weight: bold; color: #f59e0b;">0</div>
                </div>
                
                <div style="padding: 15px; background: #fce7f3; border-radius: 8px;">
                  <div style="font-size: 0.9rem; color: #64748b; margin-bottom: 5px;">메모리 사용</div>
                  <div id="perf-memory" style="font-size: 1.5rem; font-weight: bold; color: #ec4899;">0 KB</div>
                </div>
                
              </div>
              
              <div style="margin-top: 15px; padding: 10px; background: #f8fafc; border-radius: 8px; font-size: 0.85rem; color: #64748b;">
                <strong>💡 팁:</strong> 캐시 적중률이 높을수록 성능이 좋습니다. 새로고침 버튼을 누르면 캐시가 초기화됩니다.
              </div>
            </div>
          </div>
          
        </div>
      </section>
      <!-- 종목 검색 -->
      <section id="tab-search" class="tab-content">
        <div class="tab-header">
          <button class="back-btn" onclick="goBack()">
            <span class="back-icon">←</span> 뒤로
          </button>
          <h2>🔍 종목 검색</h2>
        </div>
        <div class="search-box">
          <input type="text" id="stock-search-input" placeholder="종목명 또는 코드 입력">
          <button id="stock-search-btn">검색</button>
        </div>
        <div id="search-result" class="result-area"></div>
      </section>
      
      <!-- 테마 분석 -->
      <section id="tab-theme" class="tab-content">
        <h2>🎯 테마 분석</h2>
        <div class="card" style="margin-bottom:20px;">
          <h3>📋 테마 목록</h3>
          <button id="load-theme-btn">테마 목록 불러오기</button>
          <div id="theme-list-container" style="max-height:300px; overflow-y:auto; margin-top:15px;">
            <p>테마 목록을 불러와 주세요.</p>
          </div>
        </div>
        <div class="card" id="theme-stocks-card" style="display:none; overflow-x:auto;">
          <h3>📈 <span id="selected-theme-name">테마</span> 종목</h3>
          <div id="theme-stocks-container"></div>
        </div>
        <div class="card" id="theme-analysis-card" style="display:none; margin-top:20px;">
          <h3>🏆 종목 순위 (점수 기준)</h3>
          <div id="theme-analysis-result"></div>
        </div>
      </section>
      
      <!-- 기술적 분석 -->
      <section id="tab-analysis" class="tab-content">
        <div class="tab-header">
          <button class="back-btn" onclick="goBack()">
            <span class="back-icon">←</span> 뒤로
          </button>
          <h2>📊 기술적 분석</h2>
        </div>
        <div class="search-box">
          <input type="text" id="analysis-stock-code" placeholder="종목코드 입력 (예: 005930)">
          <button id="run-analysis-btn">분석 시작</button>
          <button id="go-signals-btn" class="btn-success">🚦 매매신호</button>
          <button id="news-btn" class="btn-secondary">📰 뉴스</button>
        </div>
        <div class="card" style="margin-top:20px;">
          <h3>📈 주가 차트</h3>

          <div style="margin-bottom: 10px; display: flex; gap: 5px;">
            <button class="timeframe-btn active" data-timeframe="daily" onclick="changeTimeframe('daily')">일봉</button>
            <button class="timeframe-btn" data-timeframe="weekly" onclick="changeTimeframe('weekly')">주봉</button>
            <button class="timeframe-btn" data-timeframe="monthly" onclick="changeTimeframe('monthly')">월봉</button>
          </div>

          <div style="margin-bottom: 10px; display: flex; flex-wrap: wrap; gap: 5px;">
            <button class="indicator-btn active" data-indicator="ma" onclick="toggleIndicator('ma')">이동평균선</button>
            <button class="indicator-btn active" data-indicator="bb" onclick="toggleIndicator('bb')">볼린저밴드</button>
            <button class="indicator-btn" data-indicator="ichimoku" onclick="toggleIndicator('ichimoku')">일목균형표</button>
            <button class="indicator-btn active" data-indicator="volume" onclick="toggleIndicator('volume')">거래량</button>
          </div>
          <div class="chart-wrapper">
            <div class="chart-container">
              <div id="stock-chart" style="width: 100%; height: 100%;"></div>
            </div>
          </div>
        </div>


        <!-- 차트 패턴 인식 -->
        <div class="pattern-section" style="margin: 20px 0; padding: 15px; background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
          <h3 style="margin: 0 0 15px 0; color: #333;">📈 차트 패턴 인식</h3>
          
          <button id="analyzePatternBtn" class="btn" style="width: 100%; padding: 12px; font-size: 16px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 6px; cursor: pointer;">
            🔍 패턴 분석 시작
          </button>
          
          <div id="patternResults" style="margin-top: 15px; display: none;">
            <h4 style="margin: 10px 0; color: #555;">발견된 패턴:</h4>
            <div id="patternList"></div>
          </div>
        </div>


        <!-- 미국 주식 차트 패턴 인식 가이드 -->
<div style="margin-top:15px;">
  <button onclick="toggleUsPatternGuide()" style="width:100%; padding:12px; background:#e0f2fe; border:1px solid #7dd3fc; border-radius:8px; cursor:pointer; font-weight:bold; text-align:left; display:flex; justify-content:space-between; align-items:center;">
    <span>📖 차트 패턴 인식 가이드</span>
    <span id="usPatternGuideToggle">▼</span>
  </button>
  <div id="usPatternGuideContent" style="display:none; padding:15px; background:#f0f9ff; border-radius:0 0 8px 8px; border:1px solid #7dd3fc; border-top:none; margin-top:-1px;">
    
    <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
      <h4 style="margin:0 0 10px 0; color:#3b82f6;">📊 차트 패턴 인식이란?</h4>
      <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
        <li><strong>의미:</strong> 과거 주가 흐름에서 반복되는 가격 패턴을 찾아내는 기술</li>
        <li><strong>목적:</strong> 패턴이 완성되면 이후 주가 방향을 예측</li>
        <li><strong>현재 지원:</strong> 더블탑(하락 신호), 더블바텀(상승 신호)</li>
        <li><strong>신뢰도:</strong> 60~100점 (높을수록 패턴이 명확함)</li>
      </ul>
    </div>
    
    <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
      <h4 style="margin:0 0 10px 0; color:#ef4444;">📉 더블탑 (Double Top)</h4>
      <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
        <li><strong>모양:</strong> M자 형태 (두 번의 비슷한 고점)</li>
        <li><strong>의미:</strong> 상승 추세가 끝나고 하락으로 전환되는 신호</li>
        <li><strong>발생 조건:</strong> 
          <ul style="margin-top:5px; padding-left:20px;">
            <li>첫 번째 고점 형성</li>
            <li>중간에 일시적 하락 (저점)</li>
            <li>다시 상승하여 비슷한 고점 형성 (오차 4% 이내)</li>
            <li>중간 저점을 하향 돌파하면 패턴 완성</li>
          </ul>
        </li>
        <li><strong>목표가:</strong> 중간 저점 - (고점과 저점의 차이)</li>
        <li><strong>전략:</strong> 패턴 완성 시 매도 또는 공매도</li>
      </ul>
    </div>
    
    <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
      <h4 style="margin:0 0 10px 0; color:#10b981;">📈 더블바텀 (Double Bottom)</h4>
      <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
        <li><strong>모양:</strong> W자 형태 (두 번의 비슷한 저점)</li>
        <li><strong>의미:</strong> 하락 추세가 끝나고 상승으로 전환되는 신호</li>
        <li><strong>발생 조건:</strong>
          <ul style="margin-top:5px; padding-left:20px;">
            <li>첫 번째 저점 형성</li>
            <li>중간에 일시적 반등 (고점)</li>
            <li>다시 하락하여 비슷한 저점 형성 (오차 4% 이내)</li>
            <li>중간 고점을 상향 돌파하면 패턴 완성</li>
          </ul>
        </li>
        <li><strong>목표가:</strong> 중간 고점 + (고점과 저점의 차이)</li>
        <li><strong>전략:</strong> 패턴 완성 시 매수</li>
      </ul>
    </div>
    
    <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
      <h4 style="margin:0 0 10px 0; color:#7c3aed;">🎯 신뢰도 점수 해석</h4>
      <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
        <li><strong>90점 이상:</strong> 매우 명확한 패턴 → 신뢰도 높음</li>
        <li><strong>80~89점:</strong> 명확한 패턴 → 실전 매매 가능</li>
        <li><strong>70~79점:</strong> 준수한 패턴 → 다른 지표와 함께 확인</li>
        <li><strong>60~69점:</strong> 약한 패턴 → 참고용으로만 활용</li>
        <li><strong>60점 미만:</strong> 표시 안 됨 (신뢰도 부족)</li>
      </ul>
    </div>
    
    <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
      <h4 style="margin:0 0 10px 0; color:#f59e0b;">📌 실전 활용 팁</h4>
      <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
        <li><strong>단독 사용 금지:</strong> 반드시 RSI, MACD 등 다른 지표와 함께 확인</li>
        <li><strong>거래량 확인:</strong> 패턴 완성 시 거래량이 증가하면 신뢰도 UP</li>
        <li><strong>추세 확인:</strong> 전체 추세(상승장/하락장)를 먼저 파악</li>
        <li><strong>손절가 설정:</strong> 목표가만큼 손절가도 반드시 설정</li>
        <li><strong>조기 진입 주의:</strong> 패턴이 완성되기 전 진입은 위험</li>
      </ul>
    </div>
    
    <div style="padding:10px; background:white; border-radius:6px;">
      <h4 style="margin:0 0 10px 0; color:#dc2626;">⚠️ 주의사항</h4>
      <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
        <li><strong>실패 가능성:</strong> 모든 패턴이 100% 성공하는 것은 아님</li>
        <li><strong>허위 돌파:</strong> 패턴이 완성된 것처럼 보였다가 실패할 수 있음</li>
        <li><strong>시간:</strong> 패턴 형성에 최소 10일~수개월 소요</li>
        <li><strong>오차 범위:</strong> 두 고점/저점의 가격 차이는 4% 이내만 인정</li>
        <li><strong>미발견:</strong> 패턴이 없다고 나오는 것이 더 정상 (엄격한 기준)</li>
      </ul>
    </div>
    
    <div style="margin-top:15px; padding:10px; background:#fef3c7; border-radius:6px; border-left:4px solid #f59e0b;">
      <p style="margin:0; font-size:0.85rem; color:#92400e; line-height:1.6;">
        <strong>💡 TIP:</strong> 차트 패턴은 "과거에 이런 모양이 나타났을 때 이렇게 움직였다"는 통계적 접근입니다. 100% 정확하지 않으므로 반드시 손절가를 설정하고, 다른 기술적 지표(RSI, MACD)와 거래량을 함께 확인하세요. 특히 신뢰도 70점 미만은 무시하고, 80점 이상만 참고하는 것을 권장합니다.
      </p>
    </div>
    
  </div>
</div>


        <!-- 차트 패턴 인식 가이드 -->
<div style="margin-top:15px;">
  <button onclick="togglePatternGuide()" style="width:100%; padding:12px; background:#e0f2fe; border:1px solid #7dd3fc; border-radius:8px; cursor:pointer; font-weight:bold; text-align:left; display:flex; justify-content:space-between; align-items:center;">
    <span>📖 차트 패턴 인식 가이드</span>
    <span id="patternGuideToggle">▼</span>
  </button>
  <div id="patternGuideContent" style="display:none; padding:15px; background:#f0f9ff; border-radius:0 0 8px 8px; border:1px solid #7dd3fc; border-top:none; margin-top:-1px;">
    
    <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
      <h4 style="margin:0 0 10px 0; color:#3b82f6;">📊 차트 패턴 인식이란?</h4>
      <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
        <li><strong>의미:</strong> 과거 주가 흐름에서 반복되는 가격 패턴을 찾아내는 기술</li>
        <li><strong>목적:</strong> 패턴이 완성되면 이후 주가 방향을 예측</li>
        <li><strong>현재 지원:</strong> 더블탑(하락 신호), 더블바텀(상승 신호)</li>
        <li><strong>신뢰도:</strong> 60~100점 (높을수록 패턴이 명확함)</li>
      </ul>
    </div>
    
    <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
      <h4 style="margin:0 0 10px 0; color:#ef4444;">📉 더블탑 (Double Top)</h4>
      <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
        <li><strong>모양:</strong> M자 형태 (두 번의 비슷한 고점)</li>
        <li><strong>의미:</strong> 상승 추세가 끝나고 하락으로 전환되는 신호</li>
        <li><strong>발생 조건:</strong> 
          <ul style="margin-top:5px; padding-left:20px;">
            <li>첫 번째 고점 형성</li>
            <li>중간에 일시적 하락 (저점)</li>
            <li>다시 상승하여 비슷한 고점 형성 (오차 4% 이내)</li>
            <li>중간 저점을 하향 돌파하면 패턴 완성</li>
          </ul>
        </li>
        <li><strong>목표가:</strong> 중간 저점 - (고점과 저점의 차이)</li>
        <li><strong>전략:</strong> 패턴 완성 시 매도 또는 공매도</li>
      </ul>
    </div>
    
    <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
      <h4 style="margin:0 0 10px 0; color:#10b981;">📈 더블바텀 (Double Bottom)</h4>
      <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
        <li><strong>모양:</strong> W자 형태 (두 번의 비슷한 저점)</li>
        <li><strong>의미:</strong> 하락 추세가 끝나고 상승으로 전환되는 신호</li>
        <li><strong>발생 조건:</strong>
          <ul style="margin-top:5px; padding-left:20px;">
            <li>첫 번째 저점 형성</li>
            <li>중간에 일시적 반등 (고점)</li>
            <li>다시 하락하여 비슷한 저점 형성 (오차 4% 이내)</li>
            <li>중간 고점을 상향 돌파하면 패턴 완성</li>
          </ul>
        </li>
        <li><strong>목표가:</strong> 중간 고점 + (고점과 저점의 차이)</li>
        <li><strong>전략:</strong> 패턴 완성 시 매수</li>
      </ul>
    </div>
    
    <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
      <h4 style="margin:0 0 10px 0; color:#7c3aed;">🎯 신뢰도 점수 해석</h4>
      <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
        <li><strong>90점 이상:</strong> 매우 명확한 패턴 → 신뢰도 높음</li>
        <li><strong>80~89점:</strong> 명확한 패턴 → 실전 매매 가능</li>
        <li><strong>70~79점:</strong> 준수한 패턴 → 다른 지표와 함께 확인</li>
        <li><strong>60~69점:</strong> 약한 패턴 → 참고용으로만 활용</li>
        <li><strong>60점 미만:</strong> 표시 안 됨 (신뢰도 부족)</li>
      </ul>
    </div>
    
    <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
      <h4 style="margin:0 0 10px 0; color:#f59e0b;">📌 실전 활용 팁</h4>
      <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
        <li><strong>단독 사용 금지:</strong> 반드시 RSI, MACD 등 다른 지표와 함께 확인</li>
        <li><strong>거래량 확인:</strong> 패턴 완성 시 거래량이 증가하면 신뢰도 UP</li>
        <li><strong>추세 확인:</strong> 전체 추세(상승장/하락장)를 먼저 파악</li>
        <li><strong>손절가 설정:</strong> 목표가만큼 손절가도 반드시 설정</li>
        <li><strong>조기 진입 주의:</strong> 패턴이 완성되기 전 진입은 위험</li>
      </ul>
    </div>
    
    <div style="padding:10px; background:white; border-radius:6px;">
      <h4 style="margin:0 0 10px 0; color:#dc2626;">⚠️ 주의사항</h4>
      <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
        <li><strong>실패 가능성:</strong> 모든 패턴이 100% 성공하는 것은 아님</li>
        <li><strong>허위 돌파:</strong> 패턴이 완성된 것처럼 보였다가 실패할 수 있음</li>
        <li><strong>시간:</strong> 패턴 형성에 최소 10일~수개월 소요</li>
        <li><strong>오차 범위:</strong> 두 고점/저점의 가격 차이는 4% 이내만 인정</li>
        <li><strong>미발견:</strong> 패턴이 없다고 나오는 것이 더 정상 (엄격한 기준)</li>
      </ul>
    </div>
    
    <div style="margin-top:15px; padding:10px; background:#fef3c7; border-radius:6px; border-left:4px solid #f59e0b;">
      <p style="margin:0; font-size:0.85rem; color:#92400e; line-height:1.6;">
        <strong>💡 TIP:</strong> 차트 패턴은 "과거에 이런 모양이 나타났을 때 이렇게 움직였다"는 통계적 접근입니다. 100% 정확하지 않으므로 반드시 손절가를 설정하고, 다른 기술적 지표(RSI, MACD)와 거래량을 함께 확인하세요. 특히 신뢰도 70점 미만은 무시하고, 80점 이상만 참고하는 것을 권장합니다.
      </p>
    </div>
    
  </div>
</div>

        <div class="card" style="margin-top:20px;">
          <h3>📊 보조 지표 선택</h3>
          <div style="display: flex; flex-wrap: wrap; gap: 5px;">
            <button class="sub-indicator-btn active" data-sub-indicator="rsi" onclick="toggleSubIndicator('rsi')">RSI</button>
            <button class="sub-indicator-btn active" data-sub-indicator="macd" onclick="toggleSubIndicator('macd')">MACD</button>
            <button class="sub-indicator-btn active" data-sub-indicator="stochastic" onclick="toggleSubIndicator('stochastic')">스토캐스틱</button>
            <button class="sub-indicator-btn active" data-sub-indicator="atr" onclick="toggleSubIndicator('atr')">ATR</button>
          </div>
        </div>


        <div class="card" style="margin-top:10px;">
          <h3>📉 RSI (14)</h3>
          <div class="chart-wrapper">
            <div class="chart-container" style="height: 150px;">
              <div id="rsi-chart" style="width: 100%; height: 100%;"></div>
            </div>
          </div>
          
          <!-- RSI 설명 패널 -->
          <div style="margin-top:15px;">
            <button onclick="toggleRsiGuide()" style="width:100%; padding:12px; background:#e0f2fe; border:1px solid #7dd3fc; border-radius:8px; cursor:pointer; font-weight:bold; text-align:left; display:flex; justify-content:space-between; align-items:center;">
              <span>📖 RSI 해석 가이드</span>
              <span id="rsiGuideToggle">▼</span>
            </button>
            <div id="rsiGuideContent" style="display:none; padding:15px; background:#f0f9ff; border-radius:0 0 8px 8px; border:1px solid #7dd3fc; border-top:none; margin-top:-1px;">
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#3b82f6;">📊 RSI란?</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>의미:</strong> Relative Strength Index (상대강도지수)</li>
<<<<<<< HEAD
                  <li><strong>기간:</strong> 보통 14일 기준으로 계산</li>
                  <li><strong>범위:</strong> 0 ~ 100 사이 값</li>
                  <li><strong>목적:</strong> 과매수/과매도 판단으로 매매 타이밍 포착</li>
=======
                  <li><strong>범위:</strong> 0 ~ 100 사이 값</li>
                  <li><strong>기간:</strong> 보통 14일 기준으로 계산</li>
                  <li><strong>목적:</strong> 과매수/과매도 상태를 판단</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#dc2626;">🔴 과매수 (Overbought)</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
<<<<<<< HEAD
                  <li><strong>RSI 70 이상:</strong> 과매수 신호 → 조정 가능성 높음</li>
                  <li><strong>의미:</strong> 최근 상승이 과도하여 단기 하락 압력 존재</li>
                  <li><strong>전략:</strong> 단기 익절 고려, 신규 매수 주의</li>
                  <li><strong>예외:</strong> 강한 상승 추세에서는 80-90까지 상승 가능</li>
=======
                  <li><strong>70 이상:</strong> 과매수 구간 → 조정 가능성</li>
                  <li><strong>의미:</strong> 주가가 과도하게 상승한 상태</li>
                  <li><strong>신호:</strong> 단기 조정 또는 하락 가능성</li>
                  <li><strong>전략:</strong> 익절 타이밍 고려, 추가 매수 신중</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#3b82f6;">🔵 과매도 (Oversold)</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
<<<<<<< HEAD
                  <li><strong>RSI 30 이하:</strong> 과매도 신호 → 반등 가능성 높음</li>
                  <li><strong>의미:</strong> 최근 하락이 과도하여 단기 반등 압력 존재</li>
                  <li><strong>전략:</strong> 분할 매수 고려, 손절 후 재진입 타이밍</li>
                  <li><strong>예외:</strong> 강한 하락 추세에서는 10-20까지 하락 가능</li>
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#16a34a;">📈 실전 활용 전략</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>다이버전스:</strong> 가격은 상승인데 RSI는 하락 → 추세 약화 신호</li>
                  <li><strong>중심선 (50):</strong> 50 위는 강세장, 50 아래는 약세장</li>
                  <li><strong>추세 확인:</strong> RSI가 50선을 돌파하면 추세 전환 가능성</li>
                  <li><strong>단기 매매:</strong> 30 근처 매수 → 70 근처 매도</li>
                  <li><strong>장기 투자:</strong> RSI는 참고만, 펀더멘털 함께 분석</li>
=======
                  <li><strong>30 이하:</strong> 과매도 구간 → 반등 가능성</li>
                  <li><strong>의미:</strong> 주가가 과도하게 하락한 상태</li>
                  <li><strong>신호:</strong> 단기 반등 가능성</li>
                  <li><strong>전략:</strong> 분할 매수 타이밍 고려</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="padding:10px; background:white; border-radius:6px;">
<<<<<<< HEAD
                <h4 style="margin:0 0 10px 0; color:#7c3aed;">⚠️ 주의사항</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>단독 사용 금지:</strong> RSI만으로 매매하지 말고 다른 지표와 함께 분석</li>
                  <li><strong>추세 무시:</strong> 강한 추세에서는 과매수/과매도가 오래 지속됨</li>
                  <li><strong>거짓 신호:</strong> 횡보장에서는 신호가 부정확할 수 있음</li>
                  <li><strong>타임프레임:</strong> 일봉 RSI와 주봉 RSI를 함께 확인</li>
=======
                <h4 style="margin:0 0 10px 0; color:#16a34a;">💡 실전 활용</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>30 이하:</strong> 매수 관심 구간 (단, 추세 확인 필요)</li>
                  <li><strong>50 부근:</strong> 중립 구간</li>
                  <li><strong>70 이상:</strong> 매도 관심 구간 (익절 고려)</li>
                  <li><strong>다이버전스:</strong> 주가와 RSI가 반대로 움직이면 추세 전환 신호</li>
                  <li><strong>주의:</strong> 강한 상승/하락 추세에서는 오랫동안 과매수/과매도 유지 가능</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="margin-top:15px; padding:10px; background:#fef3c7; border-radius:6px; border-left:4px solid #f59e0b;">
                <p style="margin:0; font-size:0.85rem; color:#92400e; line-height:1.6;">
<<<<<<< HEAD
                  <strong>💡 TIP:</strong> RSI는 단기 과열/침체를 판단하는 지표입니다. 30 이하에서 매수, 70 이상에서 매도 신호로 활용하되, 반드시 다른 지표(MACD, 이동평균선)와 함께 종합 판단하세요.
=======
                  <strong>💡 TIP:</strong> RSI는 단독으로 사용하기보다 MACD, 이동평균선 등 다른 지표와 함께 확인하는 것이 좋습니다. 특히 거래량과 함께 분석하면 신뢰도가 높아집니다.
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </p>
              </div>
              
            </div>
          </div>
        </div>

        <div class="card" style="margin-top:10px;">
          <h3>📊 MACD (12, 26, 9)</h3>
          <div class="chart-wrapper">
            <div class="chart-container" style="height: 150px;">
              <div id="macd-chart" style="width: 100%; height: 100%;"></div>
            </div>
          </div>
          
          <!-- MACD 설명 패널 -->
          <div style="margin-top:15px;">
            <button onclick="toggleMacdGuide()" style="width:100%; padding:12px; background:#e0f2fe; border:1px solid #7dd3fc; border-radius:8px; cursor:pointer; font-weight:bold; text-align:left; display:flex; justify-content:space-between; align-items:center;">
              <span>📖 MACD 해석 가이드</span>
              <span id="macdGuideToggle">▼</span>
            </button>
            <div id="macdGuideContent" style="display:none; padding:15px; background:#f0f9ff; border-radius:0 0 8px 8px; border:1px solid #7dd3fc; border-top:none; margin-top:-1px;">
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#3b82f6;">📊 MACD란?</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>의미:</strong> Moving Average Convergence Divergence (이동평균 수렴확산)</li>
                  <li><strong>구성:</strong> MACD선(12-26), 시그널선(9일), 히스토그램(차이)</li>
                  <li><strong>목적:</strong> 추세의 방향과 강도, 전환점 파악</li>
                  <li><strong>특징:</strong> 중장기 추세 분석에 효과적</li>
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#16a34a;">🟢 골든크로스 (Golden Cross)</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>신호:</strong> MACD선이 시그널선을 아래에서 위로 돌파</li>
                  <li><strong>의미:</strong> 상승 모멘텀 강화 → 매수 신호</li>
                  <li><strong>강도:</strong> 0선 아래에서 발생 시 더 신뢰도 높음</li>
                  <li><strong>전략:</strong> 골든크로스 + 거래량 증가 시 매수 진입</li>
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#dc2626;">🔴 데드크로스 (Dead Cross)</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>신호:</strong> MACD선이 시그널선을 위에서 아래로 돌파</li>
                  <li><strong>의미:</strong> 하락 모멘텀 강화 → 매도 신호</li>
                  <li><strong>강도:</strong> 0선 위에서 발생 시 더 신뢰도 높음</li>
                  <li><strong>전략:</strong> 데드크로스 발생 시 익절 또는 손절 고려</li>
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#ea580c;">📊 히스토그램 해석</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>의미:</strong> MACD선과 시그널선의 차이 (막대 그래프)</li>
                  <li><strong>양수(위):</strong> 상승 모멘텀, 막대가 길수록 강한 상승</li>
                  <li><strong>음수(아래):</strong> 하락 모멘텀, 막대가 길수록 강한 하락</li>
                  <li><strong>0선 근처:</strong> 추세 전환 가능성 (주의 관찰)</li>
                  <li><strong>발산:</strong> 히스토그램이 커지면 추세 강화</li>
                  <li><strong>수렴:</strong> 히스토그램이 작아지면 추세 약화</li>
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#7c3aed;">🔍 다이버전스 (Divergence)</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>강세 다이버전스:</strong> 주가 저점 하락, MACD 저점 상승 → 반등 신호</li>
                  <li><strong>약세 다이버전스:</strong> 주가 고점 상승, MACD 고점 하락 → 조정 신호</li>
                  <li><strong>신뢰도:</strong> 다이버전스는 강력한 추세 전환 신호</li>
                  <li><strong>활용:</strong> 고점/저점에서 포지션 조정 타이밍</li>
                </ul>
              </div>
              
              <div style="padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#0891b2;">💡 실전 활용 전략</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>0선 돌파:</strong> MACD가 0선 위로 → 중기 상승 추세 확인</li>
                  <li><strong>0선 이탈:</strong> MACD가 0선 아래로 → 중기 하락 추세 확인</li>
                  <li><strong>추세 확인:</strong> RSI와 함께 사용하여 신호 신뢰도 향상</li>
                  <li><strong>단기 vs 중기:</strong> MACD는 중장기 매매에 더 유용</li>
                  <li><strong>횡보장 주의:</strong> 횡보장에서는 잦은 거짓 신호 발생</li>
                </ul>
              </div>
              
              <div style="margin-top:15px; padding:10px; background:#fef3c7; border-radius:6px; border-left:4px solid #f59e0b;">
                <p style="margin:0; font-size:0.85rem; color:#92400e; line-height:1.6;">
                  <strong>💡 TIP:</strong> MACD는 추세 추종 지표입니다. 골든크로스를 매수 신호로, 데드크로스를 매도 신호로 활용하되, 반드시 다른 지표와 함께 확인하세요. 특히 다이버전스는 추세 전환의 강력한 신호입니다.
                </p>
              </div>
              
            </div>
          </div>
        </div>

        
        <div class="card" style="margin-top:10px;">
          <h3>📈 스토캐스틱 (14, 3)</h3>
          <div class="chart-wrapper">
            <div class="chart-container" style="height: 150px;">
              <div id="stochastic-chart" style="width: 100%; height: 100%;"></div>
            </div>
          </div>
          
          <!-- 스토캐스틱 설명 패널 -->
          <div style="margin-top:15px;">
            <button onclick="toggleStochasticGuide()" style="width:100%; padding:12px; background:#e0f2fe; border:1px solid #7dd3fc; border-radius:8px; cursor:pointer; font-weight:bold; text-align:left; display:flex; justify-content:space-between; align-items:center;">
              <span>📖 스토캐스틱 해석 가이드</span>
              <span id="stochasticGuideToggle">▼</span>
            </button>
            <div id="stochasticGuideContent" style="display:none; padding:15px; background:#f0f9ff; border-radius:0 0 8px 8px; border:1px solid #7dd3fc; border-top:none; margin-top:-1px;">
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#3b82f6;">📊 스토캐스틱이란?</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>의미:</strong> Stochastic Oscillator (확률적 오실레이터)</li>
<<<<<<< HEAD
                  <li><strong>구성:</strong> %K선(빠른선, 14일), %D선(느린선, 3일 평균)</li>
                  <li><strong>범위:</strong> 0 ~ 100 사이 값</li>
                  <li><strong>목적:</strong> 현재 가격이 일정 기간 가격 범위의 어디에 위치하는지 파악</li>
=======
                  <li><strong>구성:</strong> %K선 (빠른선), %D선 (느린선, %K의 이동평균)</li>
                  <li><strong>범위:</strong> 0 ~ 100 사이 값</li>
                  <li><strong>목적:</strong> 현재 가격이 일정 기간의 가격 범위에서 어디에 위치하는지 파악</li>
                  <li><strong>특징:</strong> 단기 매매 신호 포착에 효과적</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
<<<<<<< HEAD
                <h4 style="margin:0 0 10px 0; color:#dc2626;">🔴 과매수 (Overbought)</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>80 이상:</strong> 과매수 구간 → 조정 가능성</li>
                  <li><strong>의미:</strong> 최근 가격이 고가 범위에 위치</li>
                  <li><strong>신호:</strong> %K선이 %D선을 위에서 아래로 교차 → 매도 신호</li>
                  <li><strong>전략:</strong> 80 이상에서 데드크로스 발생 시 단기 익절</li>
=======
                <h4 style="margin:0 0 10px 0; color:#dc2626;">🔴 과매수 구간 (Overbought)</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>80 이상:</strong> 과매수 구간 → 조정 가능성</li>
                  <li><strong>의미:</strong> 현재 가격이 최근 가격 범위의 상단에 위치</li>
                  <li><strong>신호:</strong> 단기 조정 또는 하락 반전 가능성</li>
                  <li><strong>전략:</strong> 80선 위에서 %K가 %D를 하향 돌파 시 매도 고려</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
<<<<<<< HEAD
                <h4 style="margin:0 0 10px 0; color:#3b82f6;">🔵 과매도 (Oversold)</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>20 이하:</strong> 과매도 구간 → 반등 가능성</li>
                  <li><strong>의미:</strong> 최근 가격이 저가 범위에 위치</li>
                  <li><strong>신호:</strong> %K선이 %D선을 아래에서 위로 교차 → 매수 신호</li>
                  <li><strong>전략:</strong> 20 이하에서 골든크로스 발생 시 분할 매수</li>
=======
                <h4 style="margin:0 0 10px 0; color:#3b82f6;">🔵 과매도 구간 (Oversold)</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>20 이하:</strong> 과매도 구간 → 반등 가능성</li>
                  <li><strong>의미:</strong> 현재 가격이 최근 가격 범위의 하단에 위치</li>
                  <li><strong>신호:</strong> 단기 반등 가능성</li>
                  <li><strong>전략:</strong> 20선 아래에서 %K가 %D를 상향 돌파 시 매수 고려</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
<<<<<<< HEAD
                <h4 style="margin:0 0 10px 0; color:#16a34a;">🔄 교차 신호</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>골든크로스:</strong> %K선이 %D선을 상향 돌파 → 매수 신호</li>
                  <li><strong>데드크로스:</strong> %K선이 %D선을 하향 돌파 → 매도 신호</li>
                  <li><strong>신뢰도:</strong> 과매수/과매도 구간에서 발생 시 더 신뢰도 높음</li>
                  <li><strong>예시:</strong> 20 이하에서 골든크로스 → 강한 매수 신호</li>
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#7c3aed;">🔍 다이버전스</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>강세 다이버전스:</strong> 가격 저점 하락, 스토캐스틱 저점 상승 → 반등 신호</li>
                  <li><strong>약세 다이버전스:</strong> 가격 고점 상승, 스토캐스틱 고점 하락 → 조정 신호</li>
                  <li><strong>활용:</strong> 추세 반전 예측, 고점/저점 포착</li>
=======
                <h4 style="margin:0 0 10px 0; color:#16a34a;">📈 골든크로스 (매수 신호)</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>신호:</strong> %K선이 %D선을 아래에서 위로 돌파</li>
                  <li><strong>강한 신호:</strong> 20선 이하 과매도 구간에서 발생</li>
                  <li><strong>의미:</strong> 상승 모멘텀 시작</li>
                  <li><strong>전략:</strong> 과매도 구간에서 골든크로스 + 거래량 증가 시 매수</li>
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#dc2626;">📉 데드크로스 (매도 신호)</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>신호:</strong> %K선이 %D선을 위에서 아래로 돌파</li>
                  <li><strong>강한 신호:</strong> 80선 이상 과매수 구간에서 발생</li>
                  <li><strong>의미:</strong> 하락 모멘텀 시작</li>
                  <li><strong>전략:</strong> 과매수 구간에서 데드크로스 발생 시 매도 고려</li>
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#7c3aed;">🔍 다이버전스 (Divergence)</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>강세 다이버전스:</strong> 주가 저점 하락, 스토캐스틱 저점 상승 → 반등 신호</li>
                  <li><strong>약세 다이버전스:</strong> 주가 고점 상승, 스토캐스틱 고점 하락 → 조정 신호</li>
                  <li><strong>신뢰도:</strong> 과매수/과매도 구간에서 발생 시 더 신뢰도 높음</li>
                  <li><strong>활용:</strong> 추세 전환 조기 포착에 유용</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="padding:10px; background:white; border-radius:6px;">
<<<<<<< HEAD
                <h4 style="margin:0 0 10px 0; color:#ea580c;">💡 실전 활용 전략</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>단기 매매:</strong> 스토캐스틱은 RSI보다 민감하여 단기 매매에 유리</li>
                  <li><strong>RSI와 조합:</strong> 두 지표가 모두 과매도/과매수 시 신뢰도 UP</li>
                  <li><strong>추세장:</strong> 강한 추세에서는 오랫동안 과매수/과매도 유지 가능</li>
                  <li><strong>횡보장:</strong> 횡보장에서 가장 효과적 (20↔80 구간 매매)</li>
                  <li><strong>%K와 %D 간격:</strong> 간격이 크면 강한 추세, 좁으면 추세 약화</li>
=======
                <h4 style="margin:0 0 10px 0; color:#0891b2;">💡 실전 활용 전략</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>단기 매매:</strong> 스토캐스틱은 단기 매매에 가장 효과적</li>
                  <li><strong>RSI 조합:</strong> RSI와 함께 사용하여 신호 신뢰도 향상</li>
                  <li><strong>추세 확인:</strong> 강한 추세장에서는 과매수/과매도 구간이 오래 지속될 수 있음</li>
                  <li><strong>거짓 신호:</strong> 횡보장에서는 잦은 교차로 거짓 신호 많음</li>
                  <li><strong>타이밍:</strong> 과매수/과매도 구간 + 교차 신호 + 거래량 확인</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="margin-top:15px; padding:10px; background:#fef3c7; border-radius:6px; border-left:4px solid #f59e0b;">
                <p style="margin:0; font-size:0.85rem; color:#92400e; line-height:1.6;">
<<<<<<< HEAD
                  <strong>💡 TIP:</strong> 스토캐스틱은 단기 과열/침체를 빠르게 포착하는 지표입니다. 20 이하에서 골든크로스는 매수, 80 이상에서 데드크로스는 매도 신호로 활용하되, RSI나 MACD와 함께 확인하여 신뢰도를 높이세요.
=======
                  <strong>💡 TIP:</strong> 스토캐스틱은 단기 매매에 강력한 지표입니다. 20선 이하에서 골든크로스는 매수, 80선 이상에서 데드크로스는 매도 신호로 활용하세요. 다만 강한 추세장에서는 과매수/과매도 구간이 오래 유지될 수 있으니 주의하세요.
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </p>
              </div>
              
            </div>
          </div>
        </div>  


        <div class="card" style="margin-top:10px;">
          <h3>📏 ATR (14)</h3>
          <div class="chart-wrapper">
            <div class="chart-container" style="height: 150px;">
              <div id="atr-chart" style="width: 100%; height: 100%;"></div>
            </div>
          </div>
          
          <!-- ATR 설명 패널 -->
          <div style="margin-top:15px;">
            <button onclick="toggleAtrGuide()" style="width:100%; padding:12px; background:#e0f2fe; border:1px solid #7dd3fc; border-radius:8px; cursor:pointer; font-weight:bold; text-align:left; display:flex; justify-content:space-between; align-items:center;">
              <span>📖 ATR 해석 가이드</span>
              <span id="atrGuideToggle">▼</span>
            </button>
            <div id="atrGuideContent" style="display:none; padding:15px; background:#f0f9ff; border-radius:0 0 8px 8px; border:1px solid #7dd3fc; border-top:none; margin-top:-1px;">
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#3b82f6;">📊 ATR이란?</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
<<<<<<< HEAD
                  <li><strong>의미:</strong> Average True Range (평균 진정한 범위)</li>
                  <li><strong>기간:</strong> 보통 14일 기준으로 계산</li>
                  <li><strong>측정:</strong> 일정 기간 동안의 평균 가격 변동폭</li>
                  <li><strong>목적:</strong> 변동성 측정, 손절가/목표가 설정</li>
=======
                  <li><strong>의미:</strong> Average True Range (평균 실제 범위)</li>
                  <li><strong>목적:</strong> 주가의 변동성을 측정하는 지표</li>
                  <li><strong>기간:</strong> 보통 14일 기준으로 계산</li>
                  <li><strong>특징:</strong> 방향성이 아닌 변동성의 크기만 측정</li>
                  <li><strong>단위:</strong> 가격 단위로 표시 (예: 1,000원, 2,500원)</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#dc2626;">📈 높은 ATR</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
<<<<<<< HEAD
                  <li><strong>의미:</strong> 변동성이 크다 → 가격이 크게 움직임</li>
                  <li><strong>원인:</strong> 중요 뉴스, 실적 발표, 시장 불안</li>
                  <li><strong>기회:</strong> 큰 수익 가능성</li>
                  <li><strong>위험:</strong> 큰 손실 가능성도 동시 증가</li>
                  <li><strong>전략:</strong> 포지션 크기 축소, 넓은 손절가 설정</li>
=======
                  <li><strong>의미:</strong> 변동성이 큼 (가격 변동 폭이 큼)</li>
                  <li><strong>상황:</strong> 급등/급락, 뉴스 발표, 시장 불안정</li>
                  <li><strong>기회:</strong> 큰 수익 가능성</li>
                  <li><strong>위험:</strong> 큰 손실 가능성</li>
                  <li><strong>전략:</strong> 넓은 손절가 설정, 적은 투자 비중</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#3b82f6;">📉 낮은 ATR</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
<<<<<<< HEAD
                  <li><strong>의미:</strong> 변동성이 작다 → 가격이 안정적</li>
                  <li><strong>원인:</strong> 횡보장, 거래 한산, 뉴스 없음</li>
                  <li><strong>기회:</strong> 안정적 투자, 손실 제한적</li>
                  <li><strong>단점:</strong> 수익 기회도 제한적</li>
                  <li><strong>전략:</strong> 포지션 크기 확대, 좁은 손절가 설정</li>
=======
                  <li><strong>의미:</strong> 변동성이 작음 (가격 변동 폭이 작음)</li>
                  <li><strong>상황:</strong> 횡보장, 시장 안정기</li>
                  <li><strong>기회:</strong> 안정적 투자</li>
                  <li><strong>위험:</strong> 수익률 제한적</li>
                  <li><strong>전략:</strong> 좁은 손절가 설정, 큰 투자 비중 가능</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
<<<<<<< HEAD
                <h4 style="margin:0 0 10px 0; color:#16a34a;">🎯 손절가/목표가 설정</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>손절가:</strong> 매수가 - (ATR × 2) → 평균 변동폭의 2배 하락</li>
                  <li><strong>목표가:</strong> 매수가 + (ATR × 3) → 평균 변동폭의 3배 상승</li>
                  <li><strong>리스크:리워드:</strong> 1:1.5 비율 (손실 2 vs 이익 3)</li>
                  <li><strong>예시:</strong> 현재가 10,000원, ATR 200원 → 손절 9,600원, 목표 10,600원</li>
                  <li><strong>조정:</strong> 변동성 높으면 배수 증가 (ATR × 3, × 4)</li>
=======
                <h4 style="margin:0 0 10px 0; color:#16a34a;">💰 손절가 설정</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>기본 원칙:</strong> 매수가 - (ATR × 2) = 손절가</li>
                  <li><strong>예시:</strong> 매수가 50,000원, ATR 1,000원 → 손절가 48,000원</li>
                  <li><strong>보수적:</strong> ATR × 3 (더 넓은 손절가)</li>
                  <li><strong>공격적:</strong> ATR × 1.5 (더 좁은 손절가)</li>
                  <li><strong>이유:</strong> 변동성을 고려한 합리적 손절가</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
<<<<<<< HEAD
                <h4 style="margin:0 0 10px 0; color:#ea580c;">💼 포지션 크기 결정</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>원칙:</strong> ATR이 클수록 포지션 크기 축소</li>
                  <li><strong>계산:</strong> 투자금 = 총자산 × 리스크% ÷ (ATR × 2 / 현재가)</li>
                  <li><strong>예시:</strong> 1천만원, 2% 리스크, 현재가 10,000원, ATR 200원</li>
                  <li style="padding-left:20px;">→ 투자금 = 10,000,000 × 0.02 ÷ 0.04 = 500만원</li>
                  <li><strong>효과:</strong> 변동성 큰 종목은 자동으로 적게 투자</li>
=======
                <h4 style="margin:0 0 10px 0; color:#ea580c;">🎯 목표가 설정</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>기본 원칙:</strong> 매수가 + (ATR × 2~3) = 목표가</li>
                  <li><strong>예시:</strong> 매수가 50,000원, ATR 1,000원 → 목표가 52,000~53,000원</li>
                  <li><strong>리스크 보상비:</strong> 손실:수익 = 1:1.5 이상 권장</li>
                  <li><strong>단계별 익절:</strong> ATR × 2에서 절반, ATR × 3에서 나머지</li>
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#7c3aed;">📊 포지션 크기 결정</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>원칙:</strong> ATR이 높을수록 투자 비중을 낮춤</li>
                  <li><strong>높은 ATR:</strong> 전체 자금의 10~20% 투자</li>
                  <li><strong>보통 ATR:</strong> 전체 자금의 20~30% 투자</li>
                  <li><strong>낮은 ATR:</strong> 전체 자금의 30~40% 투자</li>
                  <li><strong>이유:</strong> 변동성이 클수록 위험도가 높음</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="padding:10px; background:white; border-radius:6px;">
<<<<<<< HEAD
                <h4 style="margin:0 0 10px 0; color:#7c3aed;">💡 실전 활용 전략</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>변동성 돌파:</strong> ATR이 급증하면 큰 추세 시작 신호</li>
                  <li><strong>추세 강도:</strong> ATR 상승 중 = 추세 강함, ATR 하락 중 = 추세 약화</li>
                  <li><strong>횡보 탈출:</strong> ATR이 낮다가 급등하면 횡보 탈출 신호</li>
                  <li><strong>트레일링 스탑:</strong> 손절가를 (현재가 - ATR × 2)로 계속 상향 조정</li>
                  <li><strong>진입 타이밍:</strong> ATR이 평소보다 낮을 때 진입하면 리스크 낮음</li>
=======
                <h4 style="margin:0 0 10px 0; color:#0891b2;">💡 실전 활용</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>추세 전환:</strong> ATR 급증 시 추세 전환 가능성</li>
                  <li><strong>돌파 확인:</strong> 고점/저점 돌파 시 ATR 증가 → 진짜 돌파</li>
                  <li><strong>트레일링 스탑:</strong> 현재가 - (ATR × 2)로 손절가 계속 조정</li>
                  <li><strong>변동성 필터:</strong> ATR이 평소보다 2배 이상 → 관망</li>
                  <li><strong>종목 비교:</strong> 비슷한 가격대 종목의 ATR 비교 (상대적 변동성)</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="margin-top:15px; padding:10px; background:#fef3c7; border-radius:6px; border-left:4px solid #f59e0b;">
                <p style="margin:0; font-size:0.85rem; color:#92400e; line-height:1.6;">
<<<<<<< HEAD
                  <strong>💡 TIP:</strong> ATR은 변동성을 측정하는 지표로, 매매 신호가 아닙니다. 손절가/목표가 설정과 포지션 크기 결정에 활용하세요. ATR이 클수록 리스크가 크므로 투자 금액을 줄이고, ATR이 작을수록 안정적이므로 투자 금액을 늘릴 수 있습니다.
=======
                  <strong>💡 TIP:</strong> ATR은 위험 관리의 핵심 지표입니다. 손절가와 목표가를 ATR 기반으로 설정하면 감정적 판단을 줄이고 체계적인 투자가 가능합니다. 특히 트레일링 스탑 전략에 매우 유용합니다.
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </p>
              </div>
              
            </div>
          </div>
        </div>

        <div class="card" style="margin-top:20px;">
          <h3>📝 분석 메모</h3>
          <textarea id="analysis-memo" placeholder="이 종목에 대한 분석 메모를 작성하세요..." style="width:100%; height:100px; padding:10px; border:1px solid #ddd; border-radius:8px; resize:vertical; font-size:14px;"></textarea>
          <div style="margin-top:10px; display:flex; gap:10px;">
            <button id="save-memo-btn" class="btn-primary" style="padding:8px 16px;">💾 메모 저장</button>
            <button id="delete-memo-btn" class="btn-secondary" style="padding:8px 16px;">🗑️ 메모 삭제</button>
          </div>
          <div id="memo-status" style="margin-top:10px; font-size:12px; color:#666;"></div>
        </div>


        <div id="analysis-result" class="result-area"></div>
        <div class="card" id="news-card" style="margin-top:20px; display:none;">
          <h3>📰 관련 뉴스</h3>
          <div id="news-result"></div>
        </div>
      </section>
      
      <!-- 매매 신호 -->
      <section id="tab-signals" class="tab-content">
        <div class="tab-header">
          <button class="back-btn" onclick="goBack()">
            <span class="back-icon">←</span> 뒤로
          </button>
          <h2>🚦 매매 신호</h2>
        </div>
        <div class="search-box">
          <input type="text" id="signal-stock-code" placeholder="종목코드 입력 (예: 005930)">
          <button id="generate-signal-btn">신호 생성</button>
          <button id="recommendation-btn" class="btn-success">💰 매매점 추천</button>
        </div>
        <div id="signal-result" class="result-area"></div>
        <div id="signal-recommendation-result" class="result-area" style="margin-top:20px;"></div>
      </section>
      
      <!-- 관심 종목 -->
      <section id="tab-watchlist" class="tab-content">
        <h2>⭐ 관심 종목</h2>
        <h3>🇰🇷 한국 주식</h3>
        <div class="search-box">
          <input type="text" id="watchlist-add-code" placeholder="종목코드 입력 (예: 005930)">
          <button id="watchlist-add-btn">추가</button>
        </div>
        <div id="watchlist-container" class="result-area" style="margin-bottom:30px;">
          <p>관심 종목이 없습니다.</p>
        </div>
        <h3>🇺🇸 미국 주식</h3>
        <div class="search-box">
          <input type="text" id="us-watchlist-add-input" placeholder="심볼 입력 (예: AAPL, TSLA)">
          <button id="us-watchlist-add-btn">추가</button>
        </div>
        <div id="us-watchlist-container" class="result-area">
          <p>관심 종목이 없습니다.</p>
        </div>
      </section>
      
      <!-- 미국 주식 -->
      <section id="tab-us-stock" class="tab-content">
        <div class="tab-header">
          <button class="back-btn" onclick="goBack()">
            <span class="back-icon">←</span> 뒤로
          </button>
          <h2>🇺🇸 미국 주식</h2>
        </div>
        <div class="search-box">
          <input type="text" id="us-stock-input" placeholder="종목명 또는 심볼 (예: AAPL, TSLA)">
          <button id="us-stock-search-btn">검색</button>
        </div>
        <div id="us-search-results" class="result-area" style="margin-bottom:20px;"></div>
        <div class="card" id="us-chart-card" style="display:none;">
          <h3>📈 주가 차트</h3>

          <div style="margin-bottom: 10px; display: flex; gap: 5px;">
            <button class="us-timeframe-btn active" data-us-timeframe="daily" onclick="changeUsTimeframe('daily')">일봉</button>
            <button class="us-timeframe-btn" data-us-timeframe="weekly" onclick="changeUsTimeframe('weekly')">주봉</button>
            <button class="us-timeframe-btn" data-us-timeframe="monthly" onclick="changeUsTimeframe('monthly')">월봉</button>
          </div>

          <div style="margin-bottom: 10px; display: flex; flex-wrap: wrap; gap: 5px;">
            <button class="indicator-btn active" data-indicator="us-ma" onclick="toggleUsIndicator('ma')">이동평균선</button>
            <button class="indicator-btn active" data-indicator="us-bb" onclick="toggleUsIndicator('bb')">볼린저밴드</button>
            <button class="indicator-btn" data-indicator="us-ichimoku" onclick="toggleUsIndicator('ichimoku')">일목균형표</button>
            <button class="indicator-btn active" data-indicator="us-volume" onclick="toggleUsIndicator('volume')">거래량</button>
          </div>
          <div class="chart-wrapper">
            <div class="chart-container">
              <div id="us-stock-chart" style="width: 100%; height: 100%;"></div>
            </div>
          </div>
        </div>

        <!-- 미국 차트 패턴 인식 -->
        <div class="pattern-section" style="margin: 20px 0; padding: 15px; background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
          <h3 style="margin: 0 0 15px 0; color: #333;">📈 차트 패턴 인식</h3>
          
          <button id="analyzeUsPatternBtn" class="btn" style="width: 100%; padding: 12px; font-size: 16px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 6px; cursor: pointer;">
            🔍 패턴 분석 시작
          </button>
          
          <div id="usPatternResults" style="margin-top: 15px; display: none;">
            <h4 style="margin: 10px 0; color: #555;">발견된 패턴:</h4>
            <div id="usPatternList"></div>
          </div>
        </div>


        <div class="card" id="us-sub-indicator-card" style="display:none; margin-top:20px;">
          <h3>📊 보조 지표 선택</h3>
          <div style="display: flex; flex-wrap: wrap; gap: 5px;">
            <button class="us-sub-indicator-btn active" data-us-sub-indicator="rsi" onclick="toggleUsSubIndicator('rsi')">RSI</button>
            <button class="us-sub-indicator-btn active" data-us-sub-indicator="macd" onclick="toggleUsSubIndicator('macd')">MACD</button>
            <button class="us-sub-indicator-btn active" data-us-sub-indicator="stochastic" onclick="toggleUsSubIndicator('stochastic')">스토캐스틱</button>
            <button class="us-sub-indicator-btn active" data-us-sub-indicator="atr" onclick="toggleUsSubIndicator('atr')">ATR</button>
          </div>
        </div>


        <div class="card" id="us-rsi-card" style="display:none; margin-top:10px;">
          <h3>📉 RSI (14)</h3>
          <div class="chart-wrapper">
            <div class="chart-container" style="height: 150px;">
              <div id="us-rsi-chart" style="width: 100%; height: 100%;"></div>
            </div>
          </div>
          
<<<<<<< HEAD
          <!-- RSI 설명 패널 -->
=======
          <!-- 미국 RSI 설명 패널 -->
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
          <div style="margin-top:15px;">
            <button onclick="toggleUsRsiGuide()" style="width:100%; padding:12px; background:#e0f2fe; border:1px solid #7dd3fc; border-radius:8px; cursor:pointer; font-weight:bold; text-align:left; display:flex; justify-content:space-between; align-items:center;">
              <span>📖 RSI 해석 가이드</span>
              <span id="usRsiGuideToggle">▼</span>
            </button>
            <div id="usRsiGuideContent" style="display:none; padding:15px; background:#f0f9ff; border-radius:0 0 8px 8px; border:1px solid #7dd3fc; border-top:none; margin-top:-1px;">
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#3b82f6;">📊 RSI란?</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>의미:</strong> Relative Strength Index (상대강도지수)</li>
<<<<<<< HEAD
                  <li><strong>기간:</strong> 보통 14일 기준으로 계산</li>
                  <li><strong>범위:</strong> 0 ~ 100 사이 값</li>
                  <li><strong>목적:</strong> 과매수/과매도 판단으로 매매 타이밍 포착</li>
=======
                  <li><strong>범위:</strong> 0 ~ 100 사이 값</li>
                  <li><strong>기간:</strong> 보통 14일 기준으로 계산</li>
                  <li><strong>목적:</strong> 과매수/과매도 상태를 판단</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#dc2626;">🔴 과매수 (Overbought)</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
<<<<<<< HEAD
                  <li><strong>RSI 70 이상:</strong> 과매수 신호 → 조정 가능성 높음</li>
                  <li><strong>의미:</strong> 최근 상승이 과도하여 단기 하락 압력 존재</li>
                  <li><strong>전략:</strong> 단기 익절 고려, 신규 매수 주의</li>
                  <li><strong>예외:</strong> 강한 상승 추세에서는 80-90까지 상승 가능</li>
=======
                  <li><strong>70 이상:</strong> 과매수 구간 → 조정 가능성</li>
                  <li><strong>의미:</strong> 주가가 과도하게 상승한 상태</li>
                  <li><strong>신호:</strong> 단기 조정 또는 하락 가능성</li>
                  <li><strong>전략:</strong> 익절 타이밍 고려, 추가 매수 신중</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#3b82f6;">🔵 과매도 (Oversold)</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
<<<<<<< HEAD
                  <li><strong>RSI 30 이하:</strong> 과매도 신호 → 반등 가능성 높음</li>
                  <li><strong>의미:</strong> 최근 하락이 과도하여 단기 반등 압력 존재</li>
                  <li><strong>전략:</strong> 분할 매수 고려, 손절 후 재진입 타이밍</li>
                  <li><strong>예외:</strong> 강한 하락 추세에서는 10-20까지 하락 가능</li>
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#16a34a;">📈 실전 활용 전략</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>다이버전스:</strong> 가격은 상승인데 RSI는 하락 → 추세 약화 신호</li>
                  <li><strong>중심선 (50):</strong> 50 위는 강세장, 50 아래는 약세장</li>
                  <li><strong>추세 확인:</strong> RSI가 50선을 돌파하면 추세 전환 가능성</li>
                  <li><strong>단기 매매:</strong> 30 근처 매수 → 70 근처 매도</li>
                  <li><strong>장기 투자:</strong> RSI는 참고만, 펀더멘털 함께 분석</li>
=======
                  <li><strong>30 이하:</strong> 과매도 구간 → 반등 가능성</li>
                  <li><strong>의미:</strong> 주가가 과도하게 하락한 상태</li>
                  <li><strong>신호:</strong> 단기 반등 가능성</li>
                  <li><strong>전략:</strong> 분할 매수 타이밍 고려</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="padding:10px; background:white; border-radius:6px;">
<<<<<<< HEAD
                <h4 style="margin:0 0 10px 0; color:#7c3aed;">⚠️ 주의사항</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>단독 사용 금지:</strong> RSI만으로 매매하지 말고 다른 지표와 함께 분석</li>
                  <li><strong>추세 무시:</strong> 강한 추세에서는 과매수/과매도가 오래 지속됨</li>
                  <li><strong>거짓 신호:</strong> 횡보장에서는 신호가 부정확할 수 있음</li>
                  <li><strong>타임프레임:</strong> 일봉 RSI와 주봉 RSI를 함께 확인</li>
=======
                <h4 style="margin:0 0 10px 0; color:#16a34a;">💡 실전 활용</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>30 이하:</strong> 매수 관심 구간 (단, 추세 확인 필요)</li>
                  <li><strong>50 부근:</strong> 중립 구간</li>
                  <li><strong>70 이상:</strong> 매도 관심 구간 (익절 고려)</li>
                  <li><strong>다이버전스:</strong> 주가와 RSI가 반대로 움직이면 추세 전환 신호</li>
                  <li><strong>주의:</strong> 강한 상승/하락 추세에서는 오랫동안 과매수/과매도 유지 가능</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="margin-top:15px; padding:10px; background:#fef3c7; border-radius:6px; border-left:4px solid #f59e0b;">
                <p style="margin:0; font-size:0.85rem; color:#92400e; line-height:1.6;">
<<<<<<< HEAD
                  <strong>💡 TIP:</strong> RSI는 단기 과열/침체를 판단하는 지표입니다. 30 이하에서 매수, 70 이상에서 매도 신호로 활용하되, 반드시 다른 지표(MACD, 이동평균선)와 함께 종합 판단하세요.
=======
                  <strong>💡 TIP:</strong> RSI는 단독으로 사용하기보다 MACD, 이동평균선 등 다른 지표와 함께 확인하는 것이 좋습니다. 특히 거래량과 함께 분석하면 신뢰도가 높아집니다.
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </p>
              </div>
              
            </div>
          </div>
        </div>

        <div class="card" id="us-macd-card" style="display:none; margin-top:10px;">
          <h3>📊 MACD (12, 26, 9)</h3>
          <div class="chart-wrapper">
            <div class="chart-container" style="height: 150px;">
              <div id="us-macd-chart" style="width: 100%; height: 100%;"></div>
            </div>
          </div>
          
<<<<<<< HEAD
          <!-- MACD 설명 패널 -->
=======
          <!-- 미국 MACD 설명 패널 -->
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
          <div style="margin-top:15px;">
            <button onclick="toggleUsMacdGuide()" style="width:100%; padding:12px; background:#e0f2fe; border:1px solid #7dd3fc; border-radius:8px; cursor:pointer; font-weight:bold; text-align:left; display:flex; justify-content:space-between; align-items:center;">
              <span>📖 MACD 해석 가이드</span>
              <span id="usMacdGuideToggle">▼</span>
            </button>
            <div id="usMacdGuideContent" style="display:none; padding:15px; background:#f0f9ff; border-radius:0 0 8px 8px; border:1px solid #7dd3fc; border-top:none; margin-top:-1px;">
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#3b82f6;">📊 MACD란?</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>의미:</strong> Moving Average Convergence Divergence (이동평균 수렴확산)</li>
                  <li><strong>구성:</strong> MACD선(12-26), 시그널선(9일), 히스토그램(차이)</li>
                  <li><strong>목적:</strong> 추세의 방향과 강도, 전환점 파악</li>
                  <li><strong>특징:</strong> 중장기 추세 분석에 효과적</li>
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#16a34a;">🟢 골든크로스 (Golden Cross)</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>신호:</strong> MACD선이 시그널선을 아래에서 위로 돌파</li>
                  <li><strong>의미:</strong> 상승 모멘텀 강화 → 매수 신호</li>
                  <li><strong>강도:</strong> 0선 아래에서 발생 시 더 신뢰도 높음</li>
                  <li><strong>전략:</strong> 골든크로스 + 거래량 증가 시 매수 진입</li>
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#dc2626;">🔴 데드크로스 (Dead Cross)</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>신호:</strong> MACD선이 시그널선을 위에서 아래로 돌파</li>
                  <li><strong>의미:</strong> 하락 모멘텀 강화 → 매도 신호</li>
                  <li><strong>강도:</strong> 0선 위에서 발생 시 더 신뢰도 높음</li>
                  <li><strong>전략:</strong> 데드크로스 발생 시 익절 또는 손절 고려</li>
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#ea580c;">📊 히스토그램 해석</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>의미:</strong> MACD선과 시그널선의 차이 (막대 그래프)</li>
                  <li><strong>양수(위):</strong> 상승 모멘텀, 막대가 길수록 강한 상승</li>
                  <li><strong>음수(아래):</strong> 하락 모멘텀, 막대가 길수록 강한 하락</li>
                  <li><strong>0선 근처:</strong> 추세 전환 가능성 (주의 관찰)</li>
                  <li><strong>발산:</strong> 히스토그램이 커지면 추세 강화</li>
                  <li><strong>수렴:</strong> 히스토그램이 작아지면 추세 약화</li>
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#7c3aed;">🔍 다이버전스 (Divergence)</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>강세 다이버전스:</strong> 주가 저점 하락, MACD 저점 상승 → 반등 신호</li>
                  <li><strong>약세 다이버전스:</strong> 주가 고점 상승, MACD 고점 하락 → 조정 신호</li>
                  <li><strong>신뢰도:</strong> 다이버전스는 강력한 추세 전환 신호</li>
                  <li><strong>활용:</strong> 고점/저점에서 포지션 조정 타이밍</li>
                </ul>
              </div>
              
              <div style="padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#0891b2;">💡 실전 활용 전략</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>0선 돌파:</strong> MACD가 0선 위로 → 중기 상승 추세 확인</li>
                  <li><strong>0선 이탈:</strong> MACD가 0선 아래로 → 중기 하락 추세 확인</li>
                  <li><strong>추세 확인:</strong> RSI와 함께 사용하여 신호 신뢰도 향상</li>
                  <li><strong>단기 vs 중기:</strong> MACD는 중장기 매매에 더 유용</li>
                  <li><strong>횡보장 주의:</strong> 횡보장에서는 잦은 거짓 신호 발생</li>
                </ul>
              </div>
              
              <div style="margin-top:15px; padding:10px; background:#fef3c7; border-radius:6px; border-left:4px solid #f59e0b;">
                <p style="margin:0; font-size:0.85rem; color:#92400e; line-height:1.6;">
                  <strong>💡 TIP:</strong> MACD는 추세 추종 지표입니다. 골든크로스를 매수 신호로, 데드크로스를 매도 신호로 활용하되, 반드시 다른 지표와 함께 확인하세요. 특히 다이버전스는 추세 전환의 강력한 신호입니다.
                </p>
              </div>
              
            </div>
          </div>
        </div>

        <div class="card" id="us-stochastic-card" style="display:none; margin-top:10px;">
          <h3>📈 스토캐스틱 (14, 3)</h3>
          <div class="chart-wrapper">
            <div class="chart-container" style="height: 150px;">
              <div id="us-stochastic-chart" style="width: 100%; height: 100%;"></div>
            </div>
          </div>
          
<<<<<<< HEAD
          <!-- 스토캐스틱 설명 패널 -->
=======
          <!-- 미국 스토캐스틱 설명 패널 -->
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
          <div style="margin-top:15px;">
            <button onclick="toggleUsStochasticGuide()" style="width:100%; padding:12px; background:#e0f2fe; border:1px solid #7dd3fc; border-radius:8px; cursor:pointer; font-weight:bold; text-align:left; display:flex; justify-content:space-between; align-items:center;">
              <span>📖 스토캐스틱 해석 가이드</span>
              <span id="usStochasticGuideToggle">▼</span>
            </button>
            <div id="usStochasticGuideContent" style="display:none; padding:15px; background:#f0f9ff; border-radius:0 0 8px 8px; border:1px solid #7dd3fc; border-top:none; margin-top:-1px;">
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#3b82f6;">📊 스토캐스틱이란?</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>의미:</strong> Stochastic Oscillator (확률적 오실레이터)</li>
<<<<<<< HEAD
                  <li><strong>구성:</strong> %K선(빠른선, 14일), %D선(느린선, 3일 평균)</li>
                  <li><strong>범위:</strong> 0 ~ 100 사이 값</li>
                  <li><strong>목적:</strong> 현재 가격이 일정 기간 가격 범위의 어디에 위치하는지 파악</li>
=======
                  <li><strong>구성:</strong> %K선 (빠른선), %D선 (느린선, %K의 이동평균)</li>
                  <li><strong>범위:</strong> 0 ~ 100 사이 값</li>
                  <li><strong>목적:</strong> 현재 가격이 일정 기간의 가격 범위에서 어디에 위치하는지 파악</li>
                  <li><strong>특징:</strong> 단기 매매 신호 포착에 효과적</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
<<<<<<< HEAD
                <h4 style="margin:0 0 10px 0; color:#dc2626;">🔴 과매수 (Overbought)</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>80 이상:</strong> 과매수 구간 → 조정 가능성</li>
                  <li><strong>의미:</strong> 최근 가격이 고가 범위에 위치</li>
                  <li><strong>신호:</strong> %K선이 %D선을 위에서 아래로 교차 → 매도 신호</li>
                  <li><strong>전략:</strong> 80 이상에서 데드크로스 발생 시 단기 익절</li>
=======
                <h4 style="margin:0 0 10px 0; color:#dc2626;">🔴 과매수 구간 (Overbought)</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>80 이상:</strong> 과매수 구간 → 조정 가능성</li>
                  <li><strong>의미:</strong> 현재 가격이 최근 가격 범위의 상단에 위치</li>
                  <li><strong>신호:</strong> 단기 조정 또는 하락 반전 가능성</li>
                  <li><strong>전략:</strong> 80선 위에서 %K가 %D를 하향 돌파 시 매도 고려</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
<<<<<<< HEAD
                <h4 style="margin:0 0 10px 0; color:#3b82f6;">🔵 과매도 (Oversold)</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>20 이하:</strong> 과매도 구간 → 반등 가능성</li>
                  <li><strong>의미:</strong> 최근 가격이 저가 범위에 위치</li>
                  <li><strong>신호:</strong> %K선이 %D선을 아래에서 위로 교차 → 매수 신호</li>
                  <li><strong>전략:</strong> 20 이하에서 골든크로스 발생 시 분할 매수</li>
=======
                <h4 style="margin:0 0 10px 0; color:#3b82f6;">🔵 과매도 구간 (Oversold)</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>20 이하:</strong> 과매도 구간 → 반등 가능성</li>
                  <li><strong>의미:</strong> 현재 가격이 최근 가격 범위의 하단에 위치</li>
                  <li><strong>신호:</strong> 단기 반등 가능성</li>
                  <li><strong>전략:</strong> 20선 아래에서 %K가 %D를 상향 돌파 시 매수 고려</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
<<<<<<< HEAD
                <h4 style="margin:0 0 10px 0; color:#16a34a;">🔄 교차 신호</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>골든크로스:</strong> %K선이 %D선을 상향 돌파 → 매수 신호</li>
                  <li><strong>데드크로스:</strong> %K선이 %D선을 하향 돌파 → 매도 신호</li>
                  <li><strong>신뢰도:</strong> 과매수/과매도 구간에서 발생 시 더 신뢰도 높음</li>
                  <li><strong>예시:</strong> 20 이하에서 골든크로스 → 강한 매수 신호</li>
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#7c3aed;">🔍 다이버전스</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>강세 다이버전스:</strong> 가격 저점 하락, 스토캐스틱 저점 상승 → 반등 신호</li>
                  <li><strong>약세 다이버전스:</strong> 가격 고점 상승, 스토캐스틱 고점 하락 → 조정 신호</li>
                  <li><strong>활용:</strong> 추세 반전 예측, 고점/저점 포착</li>
=======
                <h4 style="margin:0 0 10px 0; color:#16a34a;">📈 골든크로스 (매수 신호)</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>신호:</strong> %K선이 %D선을 아래에서 위로 돌파</li>
                  <li><strong>강한 신호:</strong> 20선 이하 과매도 구간에서 발생</li>
                  <li><strong>의미:</strong> 상승 모멘텀 시작</li>
                  <li><strong>전략:</strong> 과매도 구간에서 골든크로스 + 거래량 증가 시 매수</li>
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#dc2626;">📉 데드크로스 (매도 신호)</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>신호:</strong> %K선이 %D선을 위에서 아래로 돌파</li>
                  <li><strong>강한 신호:</strong> 80선 이상 과매수 구간에서 발생</li>
                  <li><strong>의미:</strong> 하락 모멘텀 시작</li>
                  <li><strong>전략:</strong> 과매수 구간에서 데드크로스 발생 시 매도 고려</li>
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#7c3aed;">🔍 다이버전스 (Divergence)</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>강세 다이버전스:</strong> 주가 저점 하락, 스토캐스틱 저점 상승 → 반등 신호</li>
                  <li><strong>약세 다이버전스:</strong> 주가 고점 상승, 스토캐스틱 고점 하락 → 조정 신호</li>
                  <li><strong>신뢰도:</strong> 과매수/과매도 구간에서 발생 시 더 신뢰도 높음</li>
                  <li><strong>활용:</strong> 추세 전환 조기 포착에 유용</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="padding:10px; background:white; border-radius:6px;">
<<<<<<< HEAD
                <h4 style="margin:0 0 10px 0; color:#ea580c;">💡 실전 활용 전략</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>단기 매매:</strong> 스토캐스틱은 RSI보다 민감하여 단기 매매에 유리</li>
                  <li><strong>RSI와 조합:</strong> 두 지표가 모두 과매도/과매수 시 신뢰도 UP</li>
                  <li><strong>추세장:</strong> 강한 추세에서는 오랫동안 과매수/과매도 유지 가능</li>
                  <li><strong>횡보장:</strong> 횡보장에서 가장 효과적 (20↔80 구간 매매)</li>
                  <li><strong>%K와 %D 간격:</strong> 간격이 크면 강한 추세, 좁으면 추세 약화</li>
=======
                <h4 style="margin:0 0 10px 0; color:#0891b2;">💡 실전 활용 전략</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>단기 매매:</strong> 스토캐스틱은 단기 매매에 가장 효과적</li>
                  <li><strong>RSI 조합:</strong> RSI와 함께 사용하여 신호 신뢰도 향상</li>
                  <li><strong>추세 확인:</strong> 강한 추세장에서는 과매수/과매도 구간이 오래 지속될 수 있음</li>
                  <li><strong>거짓 신호:</strong> 횡보장에서는 잦은 교차로 거짓 신호 많음</li>
                  <li><strong>타이밍:</strong> 과매수/과매도 구간 + 교차 신호 + 거래량 확인</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="margin-top:15px; padding:10px; background:#fef3c7; border-radius:6px; border-left:4px solid #f59e0b;">
                <p style="margin:0; font-size:0.85rem; color:#92400e; line-height:1.6;">
<<<<<<< HEAD
                  <strong>💡 TIP:</strong> 스토캐스틱은 단기 과열/침체를 빠르게 포착하는 지표입니다. 20 이하에서 골든크로스는 매수, 80 이상에서 데드크로스는 매도 신호로 활용하되, RSI나 MACD와 함께 확인하여 신뢰도를 높이세요.
=======
                  <strong>💡 TIP:</strong> 스토캐스틱은 단기 매매에 강력한 지표입니다. 20선 이하에서 골든크로스는 매수, 80선 이상에서 데드크로스는 매도 신호로 활용하세요. 다만 강한 추세장에서는 과매수/과매도 구간이 오래 유지될 수 있으니 주의하세요.
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </p>
              </div>
              
            </div>
          </div>
        </div>


        <div class="card" id="us-atr-card" style="display:none; margin-top:10px;">
          <h3>📏 ATR (14)</h3>
          <div class="chart-wrapper">
            <div class="chart-container" style="height: 150px;">
              <div id="us-atr-chart" style="width: 100%; height: 100%;"></div>
            </div>
          </div>
          
<<<<<<< HEAD
          <!-- ATR 설명 패널 -->
=======
          <!-- 미국 ATR 설명 패널 -->
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
          <div style="margin-top:15px;">
            <button onclick="toggleUsAtrGuide()" style="width:100%; padding:12px; background:#e0f2fe; border:1px solid #7dd3fc; border-radius:8px; cursor:pointer; font-weight:bold; text-align:left; display:flex; justify-content:space-between; align-items:center;">
              <span>📖 ATR 해석 가이드</span>
              <span id="usAtrGuideToggle">▼</span>
            </button>
            <div id="usAtrGuideContent" style="display:none; padding:15px; background:#f0f9ff; border-radius:0 0 8px 8px; border:1px solid #7dd3fc; border-top:none; margin-top:-1px;">
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#3b82f6;">📊 ATR이란?</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
<<<<<<< HEAD
                  <li><strong>의미:</strong> Average True Range (평균 진정한 범위)</li>
                  <li><strong>기간:</strong> 보통 14일 기준으로 계산</li>
                  <li><strong>측정:</strong> 일정 기간 동안의 평균 가격 변동폭</li>
                  <li><strong>목적:</strong> 변동성 측정, 손절가/목표가 설정</li>
=======
                  <li><strong>의미:</strong> Average True Range (평균 실제 범위)</li>
                  <li><strong>목적:</strong> 주가의 변동성을 측정하는 지표</li>
                  <li><strong>기간:</strong> 보통 14일 기준으로 계산</li>
                  <li><strong>특징:</strong> 방향성이 아닌 변동성의 크기만 측정</li>
                  <li><strong>단위:</strong> 가격 단위로 표시 (예: $1.50, $3.20)</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#dc2626;">📈 높은 ATR</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
<<<<<<< HEAD
                  <li><strong>의미:</strong> 변동성이 크다 → 가격이 크게 움직임</li>
                  <li><strong>원인:</strong> 중요 뉴스, 실적 발표, 시장 불안</li>
                  <li><strong>기회:</strong> 큰 수익 가능성</li>
                  <li><strong>위험:</strong> 큰 손실 가능성도 동시 증가</li>
                  <li><strong>전략:</strong> 포지션 크기 축소, 넓은 손절가 설정</li>
=======
                  <li><strong>의미:</strong> 변동성이 큼 (가격 변동 폭이 큼)</li>
                  <li><strong>상황:</strong> 급등/급락, 뉴스 발표, 시장 불안정</li>
                  <li><strong>기회:</strong> 큰 수익 가능성</li>
                  <li><strong>위험:</strong> 큰 손실 가능성</li>
                  <li><strong>전략:</strong> 넓은 손절가 설정, 적은 투자 비중</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#3b82f6;">📉 낮은 ATR</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
<<<<<<< HEAD
                  <li><strong>의미:</strong> 변동성이 작다 → 가격이 안정적</li>
                  <li><strong>원인:</strong> 횡보장, 거래 한산, 뉴스 없음</li>
                  <li><strong>기회:</strong> 안정적 투자, 손실 제한적</li>
                  <li><strong>단점:</strong> 수익 기회도 제한적</li>
                  <li><strong>전략:</strong> 포지션 크기 확대, 좁은 손절가 설정</li>
=======
                  <li><strong>의미:</strong> 변동성이 작음 (가격 변동 폭이 작음)</li>
                  <li><strong>상황:</strong> 횡보장, 시장 안정기</li>
                  <li><strong>기회:</strong> 안정적 투자</li>
                  <li><strong>위험:</strong> 수익률 제한적</li>
                  <li><strong>전략:</strong> 좁은 손절가 설정, 큰 투자 비중 가능</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
<<<<<<< HEAD
                <h4 style="margin:0 0 10px 0; color:#16a34a;">🎯 손절가/목표가 설정</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>손절가:</strong> 매수가 - (ATR × 2) → 평균 변동폭의 2배 하락</li>
                  <li><strong>목표가:</strong> 매수가 + (ATR × 3) → 평균 변동폭의 3배 상승</li>
                  <li><strong>리스크:리워드:</strong> 1:1.5 비율 (손실 2 vs 이익 3)</li>
                  <li><strong>예시:</strong> 현재가 $100, ATR $2 → 손절 $96, 목표 $106</li>
                  <li><strong>조정:</strong> 변동성 높으면 배수 증가 (ATR × 3, × 4)</li>
=======
                <h4 style="margin:0 0 10px 0; color:#16a34a;">💰 손절가 설정</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>기본 원칙:</strong> 매수가 - (ATR × 2) = 손절가</li>
                  <li><strong>예시:</strong> 매수가 $150.00, ATR $3.00 → 손절가 $144.00</li>
                  <li><strong>보수적:</strong> ATR × 3 (더 넓은 손절가)</li>
                  <li><strong>공격적:</strong> ATR × 1.5 (더 좁은 손절가)</li>
                  <li><strong>이유:</strong> 변동성을 고려한 합리적 손절가</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
<<<<<<< HEAD
                <h4 style="margin:0 0 10px 0; color:#ea580c;">💼 포지션 크기 결정</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>원칙:</strong> ATR이 클수록 포지션 크기 축소</li>
                  <li><strong>계산:</strong> 투자금 = 총자산 × 리스크% ÷ (ATR × 2 / 현재가)</li>
                  <li><strong>예시:</strong> $10,000, 2% 리스크, 현재가 $100, ATR $2</li>
                  <li style="padding-left:20px;">→ 투자금 = $10,000 × 0.02 ÷ 0.04 = $5,000</li>
                  <li><strong>효과:</strong> 변동성 큰 종목은 자동으로 적게 투자</li>
=======
                <h4 style="margin:0 0 10px 0; color:#ea580c;">🎯 목표가 설정</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>기본 원칙:</strong> 매수가 + (ATR × 2~3) = 목표가</li>
                  <li><strong>예시:</strong> 매수가 $150.00, ATR $3.00 → 목표가 $156.00~$159.00</li>
                  <li><strong>리스크 보상비:</strong> 손실:수익 = 1:1.5 이상 권장</li>
                  <li><strong>단계별 익절:</strong> ATR × 2에서 절반, ATR × 3에서 나머지</li>
                </ul>
              </div>
              
              <div style="margin-bottom:15px; padding:10px; background:white; border-radius:6px;">
                <h4 style="margin:0 0 10px 0; color:#7c3aed;">📊 포지션 크기 결정</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>원칙:</strong> ATR이 높을수록 투자 비중을 낮춤</li>
                  <li><strong>높은 ATR:</strong> 전체 자금의 10~20% 투자</li>
                  <li><strong>보통 ATR:</strong> 전체 자금의 20~30% 투자</li>
                  <li><strong>낮은 ATR:</strong> 전체 자금의 30~40% 투자</li>
                  <li><strong>이유:</strong> 변동성이 클수록 위험도가 높음</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="padding:10px; background:white; border-radius:6px;">
<<<<<<< HEAD
                <h4 style="margin:0 0 10px 0; color:#7c3aed;">💡 실전 활용 전략</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>변동성 돌파:</strong> ATR이 급증하면 큰 추세 시작 신호</li>
                  <li><strong>추세 강도:</strong> ATR 상승 중 = 추세 강함, ATR 하락 중 = 추세 약화</li>
                  <li><strong>횡보 탈출:</strong> ATR이 낮다가 급등하면 횡보 탈출 신호</li>
                  <li><strong>트레일링 스탑:</strong> 손절가를 (현재가 - ATR × 2)로 계속 상향 조정</li>
                  <li><strong>진입 타이밍:</strong> ATR이 평소보다 낮을 때 진입하면 리스크 낮음</li>
=======
                <h4 style="margin:0 0 10px 0; color:#0891b2;">💡 실전 활용</h4>
                <ul style="margin:5px 0; padding-left:20px; line-height:1.8; font-size:0.9rem;">
                  <li><strong>추세 전환:</strong> ATR 급증 시 추세 전환 가능성</li>
                  <li><strong>돌파 확인:</strong> 고점/저점 돌파 시 ATR 증가 → 진짜 돌파</li>
                  <li><strong>트레일링 스탑:</strong> 현재가 - (ATR × 2)로 손절가 계속 조정</li>
                  <li><strong>변동성 필터:</strong> ATR이 평소보다 2배 이상 → 관망</li>
                  <li><strong>종목 비교:</strong> 비슷한 가격대 종목의 ATR 비교 (상대적 변동성)</li>
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </ul>
              </div>
              
              <div style="margin-top:15px; padding:10px; background:#fef3c7; border-radius:6px; border-left:4px solid #f59e0b;">
                <p style="margin:0; font-size:0.85rem; color:#92400e; line-height:1.6;">
<<<<<<< HEAD
                  <strong>💡 TIP:</strong> ATR은 변동성을 측정하는 지표로, 매매 신호가 아닙니다. 손절가/목표가 설정과 포지션 크기 결정에 활용하세요. ATR이 클수록 리스크가 크므로 투자 금액을 줄이고, ATR이 작을수록 안정적이므로 투자 금액을 늘릴 수 있습니다.
=======
                  <strong>💡 TIP:</strong> ATR은 위험 관리의 핵심 지표입니다. 손절가와 목표가를 ATR 기반으로 설정하면 감정적 판단을 줄이고 체계적인 투자가 가능합니다. 특히 트레일링 스탑 전략에 매우 유용합니다.
>>>>>>> e6cc8c5 (feat: 설명 패널 9개 추가 (패턴분석, RSI, MACD, 스토캐스틱, ATR))
                </p>
              </div>
              
            </div>
          </div>
        </div>


        <div id="us-stock-result" class="result-area"></div>
        <div id="us-watchlist-btn-area" style="margin-top:15px; display:none;">
          <button id="add-us-watchlist-btn" class="btn-warning">⭐ 관심 종목에 추가</button>
          <button id="us-analysis-btn" class="btn-primary">📊 기술적 분석</button>
          <button id="us-signal-btn" class="btn-success">🚦 매매 신호</button>
        </div>

        <div class="card" id="us-memo-card" style="display:none; margin-top:20px;">
          <h3>📝 분석 메모</h3>
          <textarea id="us-analysis-memo" placeholder="이 종목에 대한 분석 메모를 작성하세요..." style="width:100%; height:100px; padding:10px; border:1px solid #ddd; border-radius:8px; resize:vertical; font-size:14px;"></textarea>
          <div style="margin-top:10px; display:flex; gap:10px;">
            <button id="us-save-memo-btn" class="btn-primary" style="padding:8px 16px;">💾 메모 저장</button>
            <button id="us-delete-memo-btn" class="btn-secondary" style="padding:8px 16px;">🗑️ 메모 삭제</button>
          </div>
          <div id="us-memo-status" style="margin-top:10px; font-size:12px; color:#666;"></div>
        </div>

        <div id="us-analysis-result" class="result-area" style="margin-top:20px;"></div>
      
        
        <!-- 미국 AI 기능 -->
        <div class="card" style="margin-top:20px;">
          <h3>🤖 미국 주식 AI 분석</h3>
          <p style="color:#666; margin-bottom:15px;">AI가 매매 타이밍, 리스크, 차트 패턴을 분석합니다</p>
          
          <div class="search-box" style="margin-bottom:15px;">
            <input type="text" id="us-ai-input" placeholder="심볼 입력 (예: AAPL, TSLA)">
          </div>
          
          <div style="display:flex; flex-wrap:wrap; gap:10px;">
            <button id="us-ai-timing-btn" class="btn-primary">⏰ 매매 타이밍</button>
            <button id="us-ai-risk-btn" class="btn-primary">⚠️ 리스크 분석</button>
            <button id="us-ai-pattern-btn" class="btn-primary">📈 차트 패턴</button>
            <button id="us-ai-sentiment-btn" class="btn-primary">📰 뉴스 감성</button>
          </div>
          
          <div id="us-ai-result" style="margin-top:15px;"></div>
        </div>
        
        <!-- 미국 AI 포트폴리오 -->
        <div class="card" style="margin-top:20px;">
          <h3>💼 미국 AI 포트폴리오 추천</h3>
          <p style="color:#666; margin-bottom:15px;">종목 간 상관관계를 분석하여 최적의 투자 비중을 계산합니다</p>
          
          <div style="margin-bottom:15px;">
            <div class="search-box">
              <input type="text" id="us-ai-portfolio-input" placeholder="심볼 입력 (예: AAPL)">
              <button id="us-ai-portfolio-add-btn" class="btn-secondary">종목 추가</button>
            </div>
            <div id="us-ai-portfolio-list" style="margin-top:10px;"></div>
          </div>
          
          <div style="margin-bottom:15px;">
            <label style="margin-right:10px;">총 투자금액:</label>
            <input type="number" id="us-ai-portfolio-amount" placeholder="10000" style="width:120px;"> 달러
            <button id="us-ai-portfolio-analyze-btn" class="btn-primary" style="margin-left:15px;">최적 비중 분석</button>
          </div>
          
          <div id="us-ai-portfolio-result" style="margin-top:15px;"></div>
        </div>
      </section>
      
      
      <!-- 내 포트폴리오 -->
      <section id="tab-portfolio" class="tab-content">
        <div class="tab-header">
          <button class="back-btn" onclick="goBack()">
            <span class="back-icon">←</span> 뒤로
          </button>
          <h2>💼 내 포트폴리오</h2>
        </div>
        <div class="card">
          <h3>📝 보유 주식 등록</h3>
          <div class="search-box">
            <input type="text" id="portfolio-code" placeholder="종목코드 또는 종목명">
            <input type="number" id="portfolio-qty" placeholder="수량">
            <input type="number" id="portfolio-price" placeholder="매수가">
            <button id="portfolio-add-btn">등록</button>
          </div>
        </div>
        
        <div class="card" style="margin-top:20px;">
          <h3>📊 보유 현황</h3>
          <div id="portfolio-list">
            <p>등록된 주식이 없습니다.</p>
          </div>
        </div>
        
        <div class="card" style="margin-top:20px;">
          <h3>💰 총 평가</h3>
          <div id="portfolio-summary">
            <p>--</p>
          </div>
        </div>
        
        <div class="card" style="margin-top:20px;">
          <h3>🎯 매도 알림 설정</h3>
          <div style="margin-bottom:15px; padding:10px; background:#f0f9ff; border-radius:8px; font-size:0.9rem;">
            <p style="margin:0 0 5px 0;"><strong>📌 알림 조건 색상 안내:</strong></p>
            <p style="margin:0;">🎯 <span style="color:#16a34a;">초록색</span> = 목표가 (이 가격 도달 시 수익 실현 매도)</p>
            <p style="margin:0;">🛑 <span style="color:#dc2626;">빨간색</span> = 손절가 (이 가격 도달 시 손실 제한 매도)</p>
          </div>
          <div class="search-box">
            <select id="alert-stock-select">
              <option value="">-- 보유 종목 선택 --</option>
            </select>
            <select id="alert-type">
              <option value="percent">수익률 기준</option>
              <option value="price">가격 기준</option>
              <option value="auto">기술적 분석 (자동)</option>
            </select>
            <button id="set-alert-btn">알림 설정</button>
          </div>
          <div id="alert-options" style="margin-top:15px;">
            <div id="percent-options">
              <label><input type="checkbox" value="5"> 5% 수익</label>
              <label><input type="checkbox" value="10"> 10% 수익</label>
              <label><input type="checkbox" value="20"> 20% 수익</label>
              <label><input type="checkbox" value="30"> 30% 수익</label>
              <label><input type="checkbox" value="-5"> -5% 손절</label>
              <label><input type="checkbox" value="-10"> -10% 손절</label>
            </div>
            <div id="price-options" style="display:none;">
              <input type="number" id="alert-target-price" placeholder="목표 매도가">
              <input type="number" id="alert-stop-price" placeholder="손절가">
            </div>
          </div>
          <div style="margin-top:15px; padding-top:15px; border-top:1px solid #eee;">
            <p style="margin-bottom:10px;"><strong>📋 일괄 설정</strong></p>
            <button id="set-all-alert-btn" class="btn-primary">🔔 기술적 분석 일괄</button>
            <button id="set-all-percent-btn" class="btn-success">📊 수익률 일괄</button>
            <div id="bulk-percent-options" style="display:none; margin-top:10px; padding:10px; background:#f0f9ff; border-radius:8px;">
              <p style="margin:0 0 10px 0;">일괄 적용할 수익률 선택:</p>
              <label><input type="checkbox" class="bulk-percent" value="5"> 5% 수익</label>
              <label><input type="checkbox" class="bulk-percent" value="10"> 10% 수익</label>
              <label><input type="checkbox" class="bulk-percent" value="20"> 20% 수익</label>
              <label><input type="checkbox" class="bulk-percent" value="-5"> -5% 손절</label>
              <label><input type="checkbox" class="bulk-percent" value="-10"> -10% 손절</label>
              <br><button id="apply-bulk-percent-btn" class="btn-primary" style="margin-top:10px;">적용</button>
            </div>
          </div>
        </div>
        
        <div class="card" style="margin-top:20px;">
          <h3>🔔 알림 목록</h3>
          <div id="alert-list-container">
            <p>설정된 알림이 없습니다.</p>
          </div>
          <div style="margin-top:15px;">
            <div style="margin-top:15px;">
            <select id="monitor-interval">
              <option value="1">1분</option>
              <option value="5">5분</option>
              <option value="10" selected>10분</option>
              <option value="30">30분</option>
              <option value="60">1시간</option>
            </select>
            <button id="start-monitor-btn" class="btn-success">▶ 모니터링 시작</button>
            <button id="stop-monitor-btn" class="btn-danger" style="display:none;">⏹ 모니터링 중지</button>
            <span id="monitor-status" style="margin-left:15px; color:#666;"></span>
          </div>
        </div>

        <div class="card" style="margin-top:30px; border-top:3px solid #3b82f6;">
          <h3>🇺🇸 미국 주식 포트폴리오</h3>
          <div class="search-box">
            <input type="text" id="us-portfolio-symbol" placeholder="심볼 (예: AAPL, TSLA)">
            <input type="number" id="us-portfolio-qty" placeholder="수량">
            <input type="number" id="us-portfolio-price" placeholder="매수가 ($)" step="0.01">
            <button id="us-portfolio-add-btn">등록</button>
          </div>
        </div>
        
        <div class="card" style="margin-top:20px;">
          <h3>📊 미국 주식 보유 현황</h3>
          <div id="us-portfolio-list">
            <p>등록된 미국 주식이 없습니다.</p>
          </div>
        </div>
        
        <div class="card" style="margin-top:20px;">
          <h3>💰 미국 주식 총 평가</h3>
          <div id="us-portfolio-summary">
            <p>--</p>
          </div>
        </div>
        
        <div class="card" style="margin-top:20px;">
          <h3>🎯 미국 주식 매도 알림 설정</h3>
          <div style="margin-bottom:15px; padding:10px; background:#f0f9ff; border-radius:8px; font-size:0.9rem;">
            <p style="margin:0 0 5px 0;"><strong>📌 알림 조건 색상 안내:</strong></p>
            <p style="margin:0;">🎯 <span style="color:#16a34a;">초록색</span> = 목표가 (이 가격 도달 시 수익 실현 매도)</p>
            <p style="margin:0;">🛑 <span style="color:#dc2626;">빨간색</span> = 손절가 (이 가격 도달 시 손실 제한 매도)</p>
          </div>
          <div class="search-box">
            <select id="us-alert-stock-select">
              <option value="">-- 보유 종목 선택 --</option>
            </select>
            <select id="us-alert-type">
              <option value="percent">수익률 기준</option>
              <option value="price">가격 기준</option>
              <option value="auto">기술적 분석 (자동)</option>
            </select>
            <button id="us-set-alert-btn">알림 설정</button>
          </div>
          <div id="us-alert-options" style="margin-top:15px;">
            <div id="us-percent-options">
              <label><input type="checkbox" value="5"> 5% 수익</label>
              <label><input type="checkbox" value="10"> 10% 수익</label>
              <label><input type="checkbox" value="20"> 20% 수익</label>
              <label><input type="checkbox" value="30"> 30% 수익</label>
              <label><input type="checkbox" value="-5"> -5% 손절</label>
              <label><input type="checkbox" value="-10"> -10% 손절</label>
            </div>
            <div id="us-price-options" style="display:none;">
              <input type="number" id="us-alert-target-price" placeholder="목표 매도가 ($)" step="0.01">
              <input type="number" id="us-alert-stop-price" placeholder="손절가 ($)" step="0.01">
            </div>
          </div>
          <div style="margin-top:15px; padding-top:15px; border-top:1px solid #eee;">
            <p style="margin-bottom:10px;"><strong>📋 일괄 설정</strong></p>
            <button id="us-set-all-alert-btn" class="btn-primary">🔔 기술적 분석 일괄</button>
            <button id="us-set-all-percent-btn" class="btn-success">📊 수익률 일괄</button>
            <div id="us-bulk-percent-options" style="display:none; margin-top:10px; padding:10px; background:#f0f9ff; border-radius:8px;">
              <p style="margin:0 0 10px 0;">일괄 적용할 수익률 선택:</p>
              <label><input type="checkbox" class="us-bulk-percent" value="5"> 5% 수익</label>
              <label><input type="checkbox" class="us-bulk-percent" value="10"> 10% 수익</label>
              <label><input type="checkbox" class="us-bulk-percent" value="20"> 20% 수익</label>
              <label><input type="checkbox" class="us-bulk-percent" value="-5"> -5% 손절</label>
              <label><input type="checkbox" class="us-bulk-percent" value="-10"> -10% 손절</label>
              <br><button id="us-apply-bulk-percent-btn" class="btn-primary" style="margin-top:10px;">적용</button>
            </div>
          </div>
        </div>
        
        <div class="card" style="margin-top:20px;">
          <h3>🔔 미국 주식 알림 목록</h3>
          <div id="us-alert-list-container">
            <p>설정된 알림이 없습니다.</p>
          </div>
          <div style="margin-top:15px;">
            <select id="us-monitor-interval">
              <option value="1">1분</option>
              <option value="5">5분</option>
              <option value="10" selected>10분</option>
              <option value="30">30분</option>
              <option value="60">1시간</option>
            </select>
            <button id="us-start-monitor-btn" class="btn-success">▶ 모니터링 시작</button>
            <button id="us-stop-monitor-btn" class="btn-danger" style="display:none;">⏹ 모니터링 중지</button>
            <span id="us-monitor-status" style="margin-left:15px; color:#666;"></span>
          </div>
        </div>
      </section>
      

      <!-- 포트폴리오 최적화 -->
      <section id="tab-portfolio-optimizer" class="tab-content">
        <div class="tab-header">
          <button class="back-btn" onclick="goBack()">
            <span class="back-icon">←</span> 뒤로
          </button>
          <h2>📊 포트폴리오 최적화</h2>
        </div>

        <!-- 설정 카드 -->
        <div class="card">
          <h3>⚙️ 최적화 설정</h3>
          
          <!-- 종목 개수 설정 -->
          <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 8px; font-weight: bold;">
              📊 포트폴리오 종목 개수: <span id="stock-count-value">10</span>개
            </label>
            <input type="range" id="stock-count-slider" min="3" max="20" value="10" 
                  style="width: 100%;" oninput="updateStockCount(this.value)">
            <div style="display: flex; justify-content: space-between; font-size: 0.85rem; color: #666;">
              <span>3개</span>
              <span>20개</span>
            </div>
          </div>

          <!-- 시장 선택 -->
          <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 8px; font-weight: bold;">
              🌍 투자 시장
            </label>
            <div style="display: flex; gap: 10px;">
              <button class="market-btn active" data-market="korea">🇰🇷 한국</button>
              <button class="market-btn" data-market="us">🇺🇸 미국</button>
              <button class="market-btn" data-market="mixed">🌐 혼합</button>
            </div>
          </div>

          <!-- 선택 모드 -->
          <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 8px; font-weight: bold;">
              🎯 종목 선택 방식
            </label>
            <div style="display: flex; gap: 10px;">
              <button class="mode-btn active" data-mode="auto">🤖 AI 자동 추천</button>
              <button class="mode-btn" data-mode="manual">👤 직접 선택</button>
            </div>
          </div>

          <!-- 최적화 실행 버튼 -->
          <button id="optimize-btn" class="btn" style="width: 100%; padding: 15px; font-size: 1rem;">
            🚀 포트폴리오 최적화 시작
          </button>
        </div>

        <!-- 결과 표시 영역 -->
        <div id="optimizer-results" style="display: none;">
          <div class="card">
            <h3>📈 최적화 결과</h3>
            <div id="optimizer-result-content"></div>
          </div>
        </div>
      </section>


      <!-- 종목 찾기 -->
      <section id="tab-stock-finder" class="tab-content">
        <div class="tab-header">
          <button class="back-btn" onclick="goBack()">
            <span class="back-icon">←</span> 뒤로
          </button>
          <h2>🔍 매수 종목 찾기</h2>
        </div>
        
        <div class="card">
          <h3>🔥 Hot 테마 TOP 10</h3>
          <p style="color:#666; margin-bottom:15px;">오늘 가장 상승률이 높은 테마입니다.</p>
          <button id="load-hot-themes-btn" class="btn-primary">Hot 테마 불러오기</button>
          <div id="hot-themes-container" style="margin-top:15px;"></div>
        </div>
        
        <div class="card" style="margin-top:20px;">
          <h3>📊 테마별 추천 종목</h3>
          <p style="color:#666; margin-bottom:15px;">선택한 테마에서 기술적으로 유망한 종목 TOP 3</p>
          <div class="search-box">
            <select id="theme-select-for-analysis">
              <option value="">-- 테마 선택 --</option>
            </select>
            <button id="analyze-theme-btn">분석하기</button>
          </div>
          <div id="theme-recommendation-container" style="margin-top:15px;"></div>
        </div>
        
        <div class="card" style="margin-top:20px;">
          <h3>⭐ 전체 테마 스캔</h3>
          <p style="color:#666; margin-bottom:15px;">모든 테마를 분석하여 매수 적합 종목을 찾습니다. (시간이 걸릴 수 있습니다)</p>
          <button id="scan-all-themes-btn" class="btn-success">전체 테마 스캔 시작</button>
          <div id="scan-result-container" style="margin-top:15px;"></div>
        </div>
      </section>

      <!-- 미국 종목 찾기 -->
      <section id="tab-us-stock-finder" class="tab-content">
        <h2>🔍 미국 매수 종목 찾기</h2>
        
        <div class="card">
          <h3>🔥 인기 종목 분석</h3>
          <p style="color:#666; margin-bottom:15px;">미국 시장 대표 인기 종목들의 기술적 분석</p>
          <button id="load-popular-us-btn" class="btn-primary">인기 종목 불러오기</button>
          <div id="popular-us-container" style="margin-top:15px;"></div>
        </div>
        
        <div class="card" style="margin-top:20px;">
          <h3>📊 섹터별 추천 종목</h3>
          <p style="color:#666; margin-bottom:15px;">선택한 섹터에서 기술적으로 유망한 종목</p>
          <div class="search-box">
            <select id="us-sector-select">
              <option value="">-- 섹터 선택 --</option>
              <option value="tech">🖥️ 기술 (Technology)</option>
              <option value="healthcare">🏥 헬스케어 (Healthcare)</option>
              <option value="finance">🏦 금융 (Finance)</option>
              <option value="consumer">🛒 소비재 (Consumer)</option>
              <option value="energy">⚡ 에너지 (Energy)</option>
              <option value="industrial">🏭 산업재 (Industrial)</option>
            </select>
            <button id="analyze-us-sector-btn">분석하기</button>
          </div>
          <div id="us-sector-result-container" style="margin-top:15px;"></div>
        </div>
        
        <div class="card" style="margin-top:20px;">
          <h3>⭐ 전체 섹터 스캔</h3>
          <p style="color:#666; margin-bottom:15px;">모든 섹터를 분석하여 매수 적합 종목을 찾습니다.</p>
          <button id="scan-all-us-sectors-btn" class="btn-success">전체 섹터 스캔 시작</button>
          <div id="us-scan-result-container" style="margin-top:15px;"></div>
        </div>
      </section>

      <!-- AI 원포인트 레슨 -->
      <section id="tab-ai-lesson" class="tab-content">
        <div class="tab-header">
          <button class="back-btn" onclick="goBack()">
            <span class="back-icon">←</span> 뒤로
          </button>
          <h2>🤖 AI 원포인트 레슨</h2>
        </div>
        <p style="color:#666; margin-bottom:20px;">AI가 시가총액별, 테마별로 종목을 분석하여 객관적인 점수를 제공합니다</p>
        
        <!-- 시가총액별 TOP 10 -->
        <div class="card">
          <h3>📊 시가총액별 TOP 10</h3>
          <p style="color:#666; margin-bottom:15px;">시가총액 규모별로 기술적 분석 점수가 높은 종목</p>
          <div style="margin-bottom:15px;">
            <button id="ai-large-cap-btn" class="btn-primary">🏢 대형주</button>
            <button id="ai-mid-cap-btn" class="btn-secondary">🏠 중형주</button>
            <button id="ai-small-cap-btn" class="btn-secondary">🏪 소형주</button>
          </div>
          <div id="ai-cap-result-container"></div>
        </div>
        
        <!-- 테마별 TOP 10 -->
        <div class="card" style="margin-top:20px;">
          <h3>🎯 테마별 TOP 10</h3>
          <p style="color:#666; margin-bottom:15px;">선택한 테마 내에서 기술적 분석 점수가 높은 종목</p>
          <div class="search-box">
            <select id="ai-theme-select">
              <option value="">-- 테마 선택 --</option>
            </select>
            <button id="ai-theme-analyze-btn">분석하기</button>
          </div>
          <div id="ai-theme-result-container" style="margin-top:15px;"></div>
        </div>
        

        <!-- 직접 검색 -->
        <div class="card" style="margin-top:20px;">
          <h3>🔍 직접 검색</h3>
          <div class="search-box">
            <input type="text" id="ai-stock-input" placeholder="종목명 또는 종목코드 입력">
            <button id="ai-analyze-btn">AI 분석</button>
          </div>
          <div id="ai-direct-search-result" style="margin-top:15px;"></div>
        </div>
        
        <!-- AI 매매 타이밍 -->
        <div class="card" style="margin-top:20px;">
          <h3>⏰ AI 매매 타이밍</h3>
          <p style="color:#666; margin-bottom:15px;">골든크로스, RSI, MACD 등 복합 신호로 최적의 매수/매도 타이밍을 분석합니다</p>
          <div class="search-box">
            <input type="text" id="ai-timing-input" placeholder="종목명 또는 종목코드 입력">
            <button id="ai-timing-btn" class="btn-primary">타이밍 분석</button>
          </div>
          <div id="ai-timing-result" style="margin-top:15px;"></div>
        </div>
        
        <!-- AI 리스크 분석 -->
        <div class="card" style="margin-top:20px;">
          <h3>⚠️ AI 리스크 분석</h3>
          <p style="color:#666; margin-bottom:15px;">변동성 기반 최대 예상 손실(VaR)과 손절가를 계산합니다</p>
          <div class="search-box">
            <input type="text" id="ai-risk-input" placeholder="종목명 또는 종목코드 입력">
            <button id="ai-risk-btn" class="btn-primary">리스크 분석</button>
          </div>
          <div id="ai-risk-result" style="margin-top:15px;"></div>
        </div>
        

        <!-- AI 차트 패턴 -->
        <div class="card" style="margin-top:20px;">
          <h3>📈 AI 차트 패턴</h3>
          <p style="color:#666; margin-bottom:15px;">삼중바닥, 헤드앤숄더, 삼각수렴 등 차트 패턴을 자동 인식합니다</p>
          <div class="search-box">
            <input type="text" id="ai-pattern-input" placeholder="종목명 또는 종목코드 입력">
            <button id="ai-pattern-btn" class="btn-primary">패턴 분석</button>
          </div>
          <div id="ai-pattern-result" style="margin-top:15px;"></div>
        </div>
        
        <!-- AI 포트폴리오 추천 -->
        <div class="card" style="margin-top:20px;">
          <h3>💼 AI 포트폴리오 추천</h3>
          <p style="color:#666; margin-bottom:15px;">종목 간 상관관계를 분석하여 최적의 투자 비중을 계산합니다</p>
          <div style="margin-bottom:15px;">
            <div class="search-box">
              <input type="text" id="ai-portfolio-input" placeholder="종목명 또는 종목코드 입력">
              <button id="ai-portfolio-add-btn" class="btn-secondary">종목 추가</button>
            </div>
            <div id="ai-portfolio-list" style="margin-top:10px;"></div>
          </div>
          <div style="margin-bottom:15px;">
            <label style="margin-right:10px;">총 투자금액:</label>
            <input type="number" id="ai-portfolio-amount" placeholder="1000" style="width:120px;"> 만원
            <button id="ai-portfolio-analyze-btn" class="btn-primary" style="margin-left:15px;">최적 비중 분석</button>
          </div>
         <div id="ai-portfolio-result" style="margin-top:15px;"></div>
        </div>
        
        <!-- AI 뉴스 감성 분석 -->
        <div class="card" style="margin-top:20px;">
          <h3>📰 AI 뉴스 감성 분석</h3>
          <p style="color:#666; margin-bottom:15px;">최근 뉴스를 분석하여 긍정/부정/중립 감성을 판단합니다</p>
          <div class="search-box">
            <input type="text" id="ai-sentiment-input" placeholder="종목명 또는 종목코드 입력">
            <button id="ai-sentiment-btn" class="btn-primary">감성 분석</button>
          </div>
          <div id="ai-sentiment-result" style="margin-top:15px;"></div>
        </div>
        
        

        
        <!-- 상세 분석 결과 -->
        <div id="ai-detail-container" style="margin-top:20px;"></div>
      </section>

    </main>
  </div>
  


  <!-- 로딩 오버레이 -->
  <div id="loading-overlay" class="loading-overlay" style="display:none;">
    <div class="loading-spinner"></div>
    <p>로딩 중...</p>
  </div>
  
  <!-- JavaScript -->
  <script src="/js/app.js?v=51"></script>

  
  <script>
  // PWA 서비스 워커 등록
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', function() {
      navigator.serviceWorker.register('/service-worker.js')
        .then(function(registration) {
          console.log('ServiceWorker 등록 성공:', registration.scope);
        })
        .catch(function(error) {
          console.log('ServiceWorker 등록 실패:', error);
        });
    });
  }
</script>

<!-- 모바일 하단 고정 메뉴바 -->
<nav class="bottom-nav">
  <div class="bottom-nav-items">
    <button class="bottom-nav-item" onclick="toggleMobileMenu()">
      <span class="nav-icon">☰</span>
      <span>메뉴</span>
    </button>
    <button class="bottom-nav-item active" onclick="switchTab('dashboard')">
      <span class="nav-icon">🏠</span>
      <span>홈</span>
    </button>
    <button class="bottom-nav-item" onclick="switchTab('search')">
      <span class="nav-icon">🇰🇷</span>
      <span>한국</span>
    </button>
    <button class="bottom-nav-item" onclick="switchTab('us-stock')">
      <span class="nav-icon">🇺🇸</span>
      <span>미국</span>
    </button>
    <button class="bottom-nav-item" onclick="switchTab('ai-lesson')">
      <span class="nav-icon">🤖</span>
      <span>AI</span>
    </button>
    <button class="bottom-nav-item" onclick="switchTab('portfolio')">
      <span class="nav-icon">💼</span>
      <span>포트폴리오</span>
    </button>
  </div>
</nav>

<!-- 로그인/회원가입 모달 -->
<div id="auth-modal" class="modal" style="display:none;">
  <div class="modal-content">
    <button class="modal-close" onclick="closeAuthModal()">×</button>
    
    <!-- 로그인 폼 -->
    <div id="login-form">
      <h2>🔐 로그인</h2>
      <div class="auth-form">
        <input type="email" id="login-email" placeholder="이메일">
        <input type="password" id="login-password" placeholder="비밀번호">
        <button class="btn-primary" onclick="handleLogin()">로그인</button>
      </div>
      <p class="auth-switch">
        계정이 없으신가요? <a href="#" onclick="showRegisterForm()">회원가입</a>
      </p>
    </div>
    
    <!-- 회원가입 폼 -->
    <div id="register-form" style="display:none;">
      <h2>📝 회원가입</h2>
      <div class="auth-form">
        <input type="text" id="register-name" placeholder="이름">
        <input type="email" id="register-email" placeholder="이메일">
        <input type="password" id="register-password" placeholder="비밀번호 (6자 이상)">
        <input type="password" id="register-password-confirm" placeholder="비밀번호 확인">
        <button class="btn-primary" onclick="handleRegister()">회원가입</button>
      </div>
      <p class="auth-switch">
        이미 계정이 있으신가요? <a href="#" onclick="showLoginForm()">로그인</a>
      </p>
    </div>
  </div>
</div>

<!-- 캐싱 시스템 -->
<!-- 1. 외부 라이브러리 먼저 -->
<script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>

<!-- 2. 내부 유틸리티 -->
<script src="js/cache-manager.js"></script>

<!-- 3. 메인 앱 (마지막) -->
<script src="app.js"></script>
  
</body>
</html>